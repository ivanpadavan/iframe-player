(self.webpackChunkiframe_player=self.webpackChunkiframe_player||[]).push([[195],{8195:(Z,se,he)=>{var ee=he(9293).default;!function(){"use strict";var te={83:function(a,A,f){var T=f(537),S=f.n(T),k=f(645),C=f.n(k)()(S());C.push([a.id,'@charset "UTF-8";\n.rmp-ad-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n  outline: none;\n  display: block;\n  text-align: initial;\n}\n.rmp-vpaid-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n  outline: none;\n  display: block;\n  text-align: initial;\n}\n.rmp-ad-vast-video-player {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n  outline: none;\n  display: block;\n  cursor: pointer;\n}\n.rmp-ad-container-icons {\n  position: absolute;\n  display: block;\n  cursor: pointer;\n}\n.rmp-ad-non-linear-container {\n  position: absolute;\n  text-align: center;\n  left: 50%;\n  bottom: 0;\n  transform: translate(-50%, 0);\n}\n.rmp-ad-non-linear-creative {\n  position: relative;\n  cursor: pointer;\n  text-align: center;\n  width: 100%;\n  height: 100%;\n  bottom: 0;\n}\n.rmp-hide {\n  display: none!important;\n}\n',"",{version:3,sources:["webpack://./src/less/rmp-vast-minimal.less"],names:[],mappings:"AAAA,gBAAS;AAET;EACI,kBAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,QAAA;EACA,YAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;EACA,mBAAA;AAAJ;AAIA;EACI,kBAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,QAAA;EACA,YAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;EACA,mBAAA;AAFJ;AAKA;EACI,kBAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,QAAA;EACA,YAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;EACA,eAAA;AAHJ;AAMA;EACI,kBAAA;EACA,cAAA;EACA,eAAA;AAJJ;AAOA;EACI,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,SAAA;EACA,6BAAA;AALJ;AAQA;EACI,kBAAA;EACA,eAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,SAAA;AANJ;AASA;EACI,uBAAA;AAPJ",sourcesContent:['@charset "UTF-8";\n\n.rmp-ad-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    outline: none;\n    display: block;\n    text-align: initial;\n}\n\n// specific CSS to rmp-vast\n.rmp-vpaid-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    outline: none;\n    display: block;\n    text-align: initial;\n}\n\n.rmp-ad-vast-video-player {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    outline: none;\n    display: block;\n    cursor: pointer;\n}\n\n.rmp-ad-container-icons {\n    position: absolute;\n    display: block;\n    cursor: pointer;\n}\n\n.rmp-ad-non-linear-container {\n    position: absolute;\n    text-align: center;\n    left: 50%;\n    bottom: 0;\n    transform: translate(-50%, 0);\n}\n\n.rmp-ad-non-linear-creative {\n    position: relative;\n    cursor: pointer;\n    text-align: center;\n    width: 100%;\n    height: 100%;\n    bottom: 0;\n}\n\n.rmp-hide {\n    display: none!important;\n}\n'],sourceRoot:""}]),A.Z=C},645:function(a){a.exports=function(A){var f=[];return f.toString=function(){return this.map(function(T){var S="",k=void 0!==T[5];return T[4]&&(S+="@supports (".concat(T[4],") {")),T[2]&&(S+="@media ".concat(T[2]," {")),k&&(S+="@layer".concat(T[5].length>0?" ".concat(T[5]):""," {")),S+=A(T),k&&(S+="}"),T[2]&&(S+="}"),T[4]&&(S+="}"),S}).join("")},f.i=function(T,S,k,C,P){"string"==typeof T&&(T=[[null,T,void 0]]);var N={};if(k)for(var x=0;x<this.length;x++){var M=this[x][0];null!=M&&(N[M]=!0)}for(var W=0;W<T.length;W++){var m=[].concat(T[W]);k&&N[m[0]]||(void 0!==P&&(void 0===m[5]||(m[1]="@layer".concat(m[5].length>0?" ".concat(m[5]):""," {").concat(m[1],"}")),m[5]=P),S&&(m[2]&&(m[1]="@media ".concat(m[2]," {").concat(m[1],"}")),m[2]=S),C&&(m[4]?(m[1]="@supports (".concat(m[4],") {").concat(m[1],"}"),m[4]=C):m[4]="".concat(C)),f.push(m))}},f}},537:function(a){a.exports=function(A){var f=A[1],T=A[3];if(!T)return f;if("function"==typeof btoa){var S=btoa(unescape(encodeURIComponent(JSON.stringify(T)))),k="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(S),C="/*# ".concat(k," */");return[f].concat([C]).join("\n")}return[f].join("\n")}},379:function(a){var A=[];function f(k){for(var C=-1,P=0;P<A.length;P++)if(A[P].identifier===k){C=P;break}return C}function T(k,C){for(var P={},N=[],x=0;x<k.length;x++){var M=k[x],W=C.base?M[0]+C.base:M[0],m=P[W]||0,G="".concat(W," ").concat(m);P[W]=m+1;var D=f(G),U={css:M[1],media:M[2],sourceMap:M[3],supports:M[4],layer:M[5]};if(-1!==D)A[D].references++,A[D].updater(U);else{var ue=S(U,C);C.byIndex=x,A.splice(x,0,{identifier:G,updater:ue,references:1})}N.push(G)}return N}function S(k,C){var P=C.domAPI(C);return P.update(k),function(N){if(N){if(N.css===k.css&&N.media===k.media&&N.sourceMap===k.sourceMap&&N.supports===k.supports&&N.layer===k.layer)return;P.update(k=N)}else P.remove()}}a.exports=function(k,C){var P=T(k=k||[],C=C||{});return function(N){N=N||[];for(var x=0;x<P.length;x++){var M=f(P[x]);A[M].references--}for(var W=T(N,C),m=0;m<P.length;m++){var G=f(P[m]);0===A[G].references&&(A[G].updater(),A.splice(G,1))}P=W}}},569:function(a){var A={};a.exports=function(f,T){var S=function(k){if(void 0===A[k]){var C=document.querySelector(k);if(window.HTMLIFrameElement&&C instanceof window.HTMLIFrameElement)try{C=C.contentDocument.head}catch{C=null}A[k]=C}return A[k]}(f);if(!S)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");S.appendChild(T)}},216:function(a){a.exports=function(A){var f=document.createElement("style");return A.setAttributes(f,A.attributes),A.insert(f,A.options),f}},565:function(a,A,f){a.exports=function(T){var S=f.nc;S&&T.setAttribute("nonce",S)}},795:function(a){a.exports=function(A){if(typeof document>"u")return{update:function(){},remove:function(){}};var f=A.insertStyleElement(A);return{update:function(T){!function(S,k,C){var P="";C.supports&&(P+="@supports (".concat(C.supports,") {")),C.media&&(P+="@media ".concat(C.media," {"));var N=void 0!==C.layer;N&&(P+="@layer".concat(C.layer.length>0?" ".concat(C.layer):""," {")),P+=C.css,N&&(P+="}"),C.media&&(P+="}"),C.supports&&(P+="}");var x=C.sourceMap;x&&typeof btoa<"u"&&(P+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(x))))," */")),k.styleTagTransform(P,S,k.options)}(f,A,T)},remove:function(){!function(T){if(null===T.parentNode)return!1;T.parentNode.removeChild(T)}(f)}}}},589:function(a){a.exports=function(A,f){if(f.styleSheet)f.styleSheet.cssText=A;else{for(;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(document.createTextNode(A))}}}},K={};function R(a){var A=K[a];if(void 0!==A)return A.exports;var f=K[a]={id:a,exports:{}};return te[a](f,f.exports,R),f.exports}R.n=function(a){var A=a&&a.__esModule?function(){return a.default}:function(){return a};return R.d(A,{a:A}),A},R.d=function(a,A){for(var f in A)R.o(A,f)&&!R.o(a,f)&&Object.defineProperty(a,f,{enumerable:!0,get:A[f]})},R.o=function(a,A){return Object.prototype.hasOwnProperty.call(a,A)},R.nc=void 0;var Y={};(function(){R.d(Y,{RmpVast:function(){return qi}});class a{static _getStyleAttributeData(e,t){let n=0;if(e&&"function"==typeof window.getComputedStyle){const s=window.getComputedStyle(e,null);s&&(n=s.getPropertyValue(t),n=n.toString().toLowerCase())}return n=n.toString(),n.indexOf("px")>-1&&(n=n.replace("px","")),parseFloat(n)}static nullFn(){return null}static createSyntheticEvent(e,t){let n;if(t)try{n=new Event(e),t.dispatchEvent(n)}catch{}}static setStyle(e,t){e&&"object"==typeof t&&Object.keys(t).forEach(n=>{e.style[n]=t[n]})}static getWidth(e){return e?a.isNumber(e.offsetWidth)&&0!==e.offsetWidth?e.offsetWidth:a._getStyleAttributeData(e,"width"):0}static getHeight(e){return e?a.isNumber(e.offsetHeight)&&0!==e.offsetHeight?e.offsetHeight:a._getStyleAttributeData(e,"height"):0}static show(e){e&&e.classList.remove("rmp-hide")}static hide(e){e&&e.classList.add("rmp-hide")}static hidden(e){return!!e&&e.classList.contains("rmp-hide")}static removeElement(e){if(e&&e.parentNode)try{e.parentNode.removeChild(e)}catch{}}static isEmptyObject(e){return!(!e||"object"!=typeof e||0!==Object.keys(e).length)}static get consoleStyle(){return"color: white; background-color: #00ACC1; padding:1px 3px; border-radius: 3px; margin-right: 7px"}static get consoleStyle2(){return"color: white; background-color: #FB8C00; padding:1px 3px; border-radius: 3px; margin-right: 7px"}static get consolePrepend2(){return navigator&&navigator.userAgent&&/(edge|xbox|msie|trident)/i.test(navigator.userAgent)?"om-sdk-manager:":"om-sdk-manager%c"}static get consolePrepend(){return navigator&&navigator.userAgent&&/(edge|xbox|msie|trident)/i.test(navigator.userAgent)?"RMP-VAST:":"%crmp-vast%c"}static logVideoEvents(e,t){["loadstart","durationchange","playing","waiting","loadedmetadata","loadeddata","canplay","canplaythrough"].forEach(n=>{e.addEventListener(n,s=>{})})}static isNumber(e){return!("number"!=typeof e||!Number.isFinite(e))}static openWindow(e){try{window.open(e,"_blank")}catch{}}static ajax(e,t,n){return new Promise((s,o)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.timeout=t,n&&(r.withCredentials=!0),r.onloadend=function(){"number"==typeof r.status&&r.status>=200&&r.status<300?s("XMLHttpRequest request succeeded"):o("XMLHttpRequest wrong status code: "+r.status)},r.ontimeout=function(){o("XMLHttpRequest timeout")},r.send(null)})}}const A=document.createElement("video"),f=/(ipad|iphone|ipod)/i,T=/os\s+(\d+)_/i,S=/(macintosh|mac\s+os)/i,k=/mac\s+os\s+x\s+(\d+)_(\d+)/i,C=/safari\/[.0-9]*/i,P=/version\/(\d+)\./i,N=/(chrome|chromium|android|crios|fxios)/i,x=/macintel/i,M=/android/i,W=/android\s*(\d+)\./i;class m{static _filterVersion(e){if(navigator.userAgent){const t=navigator.userAgent.match(e);if(Array.isArray(t)&&void 0!==t[1])return parseInt(t[1],10)}return-1}static get hasTouchEvents(){return!!(void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof window.DocumentTouch)}static get userAgent(){return navigator.userAgent?navigator.userAgent:null}static get devicePixelRatio(){let e=1;return a.isNumber(window.devicePixelRatio)&&window.devicePixelRatio>1&&(e=window.devicePixelRatio),e}static get maxTouchPoints(){return"number"==typeof navigator.maxTouchPoints?navigator.maxTouchPoints:-1}static get isIos(){let e=[!1,-1];return f.test(m.userAgent)&&m.hasTouchEvents&&(e=[!0,m._filterVersion(T)]),e}static get isIpadOS(){return!!(!m.isIos[0]&&m.hasTouchEvents&&x.test(navigator.platform)&&m.devicePixelRatio>1&&m.maxTouchPoints>1)}static get isMacOS(){let e=!1,t=-1;return m.isIos[0]||m.isIpadOS||!S.test(m.userAgent)||(e=!0,t=m._filterVersion(k,!0)),[e,t]}static get isSafari(){let e=!1,t=-1;return C.test(m.userAgent)&&!N.test(m.userAgent)&&(e=!0,t=m._filterVersion(P)),[e,t]}static get isMacOSSafari(){return m.isMacOS[0]&&m.isSafari[0]}static get isAndroid(){let e=[!1,-1];return!m.isIos[0]&&m.hasTouchEvents&&M.test(m.userAgent)&&(e=[!0,m._filterVersion(W)]),e}static get isMobile(){return!!(m.isIos[0]||m.isAndroid[0]||m.isIpadOS)}static get hasNativeFullscreenSupport(){const e=document.documentElement;return!(!e||void 0===e.requestFullscreen&&void 0===e.webkitRequestFullscreen&&void 0===e.mozRequestFullScreen&&void 0===e.msRequestFullscreen&&void 0===A.webkitEnterFullscreen)}static checkCanPlayType(e,t){if("undefined"!==A.canPlayType)if(e&&t){if(""!==A.canPlayType(e+'; codecs="'+t+'"'))return!0}else if(e&&!t&&""!==A.canPlayType(e))return!0;return!1}}var D={play:function(i){return this.contentPlayer.paused&&this.contentPlayer.readyState>HTMLMediaElement.HAVE_METADATA?u.playPromise.call(this,"content",i):Promise.resolve()},pause:function(){this.contentPlayer&&!this.contentPlayer.paused&&this.contentPlayer.pause()},setVolume:function(i){this.contentPlayer&&(this.contentPlayer.volume=i)},getVolume:function(){return this.contentPlayer?this.contentPlayer.volume:-1},getMute:function(){return!!this.contentPlayer&&this.contentPlayer.muted},setMute:function(i){this.contentPlayer&&(i&&!this.contentPlayer.muted?this.contentPlayer.muted=!0:!i&&this.contentPlayer.muted&&(this.contentPlayer.muted=!1))},getDuration:function(){if(this.contentPlayer){const i=this.contentPlayer.duration;if(a.isNumber(i))return Math.round(1e3*i)}return-1},getCurrentTime:function(){if(this.contentPlayer){const i=this.contentPlayer.currentTime;if(a.isNumber(i))return Math.round(1e3*i)}return-1},seekTo:function(i){if(a.isNumber(i)&&i>=0&&this.contentPlayer){const e=Math.round(i/1e3*100)/100;this.contentPlayer.currentTime=e}},preventSeekingForCustomPlayback:function(){this.contentPlayer&&(this.antiSeekLogicInterval=setInterval(()=>{this.creative.isLinear&&this.adOnStage&&(Math.abs(this.customPlaybackCurrentTime-this.contentPlayer.currentTime)>1&&(this.contentPlayer.currentTime=this.customPlaybackCurrentTime),this.customPlaybackCurrentTime=this.contentPlayer.currentTime)},200))}};const U={},ue=["video/webm","video/mp4","video/ogg","video/3gpp","application/vnd.apple.mpegurl","application/dash+xml"],ye=function(i){const e=this.trackingTags.filter(t=>i===t.event);e.length>0&&e.forEach(t=>{U.pingURI.call(this,t.url)})};U.dispatch=function(i){Array.isArray(i)?i.forEach(e=>{ye.call(this,e)}):ye.call(this,i)};const Te=function(i){if(a.isNumber(i)&&i>=0){let e=0,t=0,n=0,s=Math.floor(i%1e3);return s=0===s?"000":s<10?"00"+s:s<100?"0"+s:s.toString(),e=Math.floor(1*i/1e3),e>59&&(t=Math.floor(1*e/60),e-=60*t),e=0===e?"00":e<10?"0"+e:e.toString(),t>59&&(n=Math.floor(1*t/60),t-=60*n),t=0===t?"00":t<10?"0"+t:t.toString(),n=0===n?"00":n<10?"0"+n:n>23?"00":n.toString(),n+":"+t+":"+e+"."+s}return"00:00:00.000"};U.replaceMacros=function(i,e){if(!/\[.+?\]/i.test(i))return i;let t=i;const n=/\[(ADCOUNT|TRANSACTIONID|PLACEMENTTYPE|BREAKMAXDURATION|BREAKMINDURATION|BREAKMAXADS|BREAKMINADLENGTH|BREAKMAXADLENGTH|IFA|IFATYPE|CLIENTUA|SERVERUA|DEVICEIP|APPBUNDLE|EXTENSIONS|VERIFICATIONVENDORS|OMIDPARTNER|INVENTORYSTATE|CONTENTID|LATLONG)\]/gi;n.test(t)&&(t=t.replace(n,"-1"));const s=/\[(CONTENTURI|CLICKPOS)\]/gi;s.test(t)&&(t=t.replace(s,"-2"));const o=/\[TIMESTAMP\]/gi,r=(new Date).toISOString();o.test(t)&&(t=t.replace(o,encodeURIComponent(r)));const l=/\[CACHEBUSTING\]/gi;l.test(t)&&(t=t.replace(l,function(){let B="";for(let z=0;z<8;z++)B+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return B}()));const d=/\[(CONTENTPLAYHEAD|MEDIAPLAYHEAD)\]/gi;let h=D.getCurrentTime.call(this);d.test(t)&&h>-1&&(t=t.replace(d,encodeURIComponent(Te(h))));const p=/\[BREAKPOSITION\]/gi,v=L.getDuration.call(this);p.test(t)&&(t=t.replace(p,0===h?"1":h>0&&h<v?"2":"3"));const g=/\[ADTYPE\]/gi;g.test(t)&&this.ad.adType&&(t=t.replace(g,encodeURIComponent(this.ad.adType)));const y=/\[DEVICEUA\]/gi;y.test(t)&&m.userAgent&&(t=t.replace(y,encodeURIComponent(m.userAgent)));const b=/\[SERVERSIDE\]/gi;b.test(t)&&m.userAgent&&(t=t.replace(b,"0"));const I=/\[DOMAIN\]/gi;I.test(t)&&window.location.hostname&&(t=t.replace(I,encodeURIComponent(window.location.hostname)));const _=/\[PAGEURL\]/gi;_.test(t)&&window.location.href&&(t=t.replace(_,encodeURIComponent(window.location.href)));const q=/\[PLAYERCAPABILITIES\]/gi;q.test(t)&&(t=t.replace(q,"skip,mute,autoplay,mautoplay,fullscreen,icon"));const Xe=/\[CLICKTYPE\]/gi;if(Xe.test(t)){let B="1";m.isMobile&&(B="2"),t=t.replace(Xe,B)}const Qe=/\[PLAYERSIZE\]/gi;if(Qe.test(t)){const B=parseInt(a.getWidth(this.container)),J=parseInt(a.getHeight(this.container));t=t.replace(Qe,encodeURIComponent(B.toString()+","+J.toString()))}if(e){const B=/\[ADPLAYHEAD\]/gi,J=L.getCurrentTime.call(this);B.test(t)&&J>-1&&(t=t.replace(B,encodeURIComponent(Te(J))));const z=/\[UNIVERSALADID\]/gi;if(z.test(t)&&this.creative.universalAdIds.length>0){let H="";this.creative.universalAdIds.forEach((tt,it)=>{0===it&&it===this.creative.universalAdIds.length-1||(H+=","),H+=tt.idRegistry+" "+tt.value}),t=t.replace(z,encodeURIComponent(H))}const ne=/\[ASSETURI\]/gi,$=this.getAdMediaUrl();ne.test(t)&&"string"==typeof $&&""!==$&&(t=t.replace(ne,encodeURIComponent($)));const ae=/\[PODSEQUENCE\]/gi;ae.test(t)&&this.ad.sequence&&(t=t.replace(ae,encodeURIComponent(this.ad.sequence.toString())));const V=/\[ADSERVINGID\]/gi;V.test(t)&&this.ad.adServingId&&(t=t.replace(V,encodeURIComponent(this.ad.adServingId)))}else{const B=/\[ADCATEGORIES\]/gi;if(B.test(t)&&this.ad.categories.length>0){const V=this.ad.categories.map(H=>H.value).join(",");t=t.replace(B,encodeURIComponent(V))}const J=/\[BLOCKEDADCATEGORIES\]/gi;if(J.test(t)&&this.ad.blockedAdCategories.length>0){const V=this.ad.blockedAdCategories.map(H=>H.value).join(",");t=t.replace(J,encodeURIComponent(V))}const z=/\[VASTVERSIONS\]/gi;z.test(t)&&(t=t.replace(z,"2,3,5,6,7,8,11,12,13,14"));const ne=/\[APIFRAMEWORKS\]/gi;ne.test(t)&&(t=t.replace(ne,"2"));const $=/\[MEDIAMIME\]/gi;if($.test(t)){let V="";ue.forEach(H=>{m.checkCanPlayType(H)&&(V+=H+",")}),V&&(V=V.slice(0,-1),t=t.replace($,encodeURIComponent(V)))}const ae=/\[PLAYERSTATE\]/gi;if(ae.test(t)){let V="";D.getMute()&&(V+="muted"),this.getFullscreen()&&(V&&(V+=","),V+="fullscreen"),t=t.replace(ae,V)}}const $e=/\[LIMITADTRACKING\]/gi;$e.test(t)&&this.regulationsInfo.limitAdTracking&&(t=t.replace($e,encodeURIComponent(this.regulationsInfo.limitAdTracking)));const Ze=/\[REGULATIONS\]/gi;Ze.test(t)&&this.regulationsInfo.regulations&&(t=t.replace(Ze,encodeURIComponent(this.regulationsInfo.regulations)));const et=/\[GDPRCONSENT\]/gi;return et.test(t)&&this.regulationsInfo.gdprConsent&&(t=t.replace(et,encodeURIComponent(this.regulationsInfo.gdprConsent))),t};const Ce=function(i){if(/\.js$/i.test(i)){const e=document.createElement("script");e.src=i;try{document.head.appendChild(e)}catch{document.body.appendChild(e)}}else a.ajax(i,this.params.ajaxTimeout,!1,"GET").then(()=>{}).catch(e=>{})};U.pingURI=function(i){const e=U.replaceMacros.call(this,i,!0);Ce.call(this,e)},U.error=function(i){let e=this.adErrorTags;303===i&&this.vastErrorTags.length>0&&(e=[...e,...this.vastErrorTags]),e.length>0&&e.forEach(t=>{if(t.url){let n=t.url;const s=/\[ERRORCODE\]/gi;s.test(n)&&a.isNumber(i)&&i>0&&i<1e3&&(n=n.replace(s,i)),Ce.call(this,n)}})};const nt=function(){this.vastPlayer.muted||0===this.vastPlayer.volume?(u.createApiEvent.call(this,"advolumemuted"),U.dispatch.call(this,"mute"),this.vastPlayerMuted=!0):this.vastPlayerMuted&&(U.dispatch.call(this,"unmute"),this.vastPlayerMuted=!1),u.createApiEvent.call(this,"advolumechanged")},at=function(){this.vastPlayerCurrentTime=L.getCurrentTime.call(this),this.vastPlayerCurrentTime>0&&(this.vastPlayerDuration>0&&this.vastPlayerDuration>this.vastPlayerCurrentTime&&(this.vastPlayerCurrentTime>=.25*this.vastPlayerDuration&&!this.firstQuartileEventFired?(this.firstQuartileEventFired=!0,u.createApiEvent.call(this,"adfirstquartile"),U.dispatch.call(this,"firstQuartile")):this.vastPlayerCurrentTime>=.5*this.vastPlayerDuration&&!this.midpointEventFired?(this.midpointEventFired=!0,u.createApiEvent.call(this,"admidpoint"),U.dispatch.call(this,"midpoint")):this.vastPlayerCurrentTime>=.75*this.vastPlayerDuration&&!this.thirdQuartileEventFired&&(this.thirdQuartileEventFired=!0,u.createApiEvent.call(this,"adthirdquartile"),U.dispatch.call(this,"thirdQuartile"))),this.progressEvents.length>0&&this.vastPlayerCurrentTime>this.progressEvents[0].time)&&(this.progressEvents.filter(i=>i.time===this.progressEvents[0].time).forEach(i=>{i.url&&U.pingURI.call(this,i.url)}),this.progressEvents.shift(),u.createApiEvent.call(this,"adprogress"))},st=function(){if(!this.vastPlayerPaused){if(this.vastPlayerPaused=!0,this.vastPlayer.currentTime===this.vastPlayer.duration)return;u.createApiEvent.call(this,"adpaused"),U.dispatch.call(this,"pause")}},rt=function(){this.vastPlayerPaused&&(this.vastPlayerPaused=!1,u.createApiEvent.call(this,"adresumed"),U.dispatch.call(this,"resume"))},ot=function(){this.vastPlayer.removeEventListener("playing",this.onPlaying),u.createApiEvent.call(this,["adimpression","adstarted"]),U.dispatch.call(this,["impression","creativeView","start"])},lt=function(){this.vastPlayer.removeEventListener("ended",this.onEnded),u.createApiEvent.call(this,"adcomplete"),U.dispatch.call(this,"complete"),L.resumeContent.call(this)};U.wire=function(){this.vastPlayer&&this.creative.isLinear&&!this.isVPAID&&(this.onPause=st.bind(this),this.vastPlayer.addEventListener("pause",this.onPause),this.onPlay=rt.bind(this),this.vastPlayer.addEventListener("play",this.onPlay),this.onPlaying=ot.bind(this),this.vastPlayer.addEventListener("playing",this.onPlaying),this.onEnded=lt.bind(this),this.vastPlayer.addEventListener("ended",this.onEnded),this.onVolumeChange=nt.bind(this),this.vastPlayer.addEventListener("volumechange",this.onVolumeChange),this.onTimeupdate=at.bind(this),this.vastPlayer.addEventListener("timeupdate",this.onTimeupdate))};var E=U;const Ee={destroy:function(){const i=this.adContainer.querySelectorAll(".rmp-ad-container-icons");i.length>0&&i.forEach(e=>{a.removeElement(e)})},parse:function(i){for(let e=0;e<i.length;e++){const t=i[e],n=t.program;if(null===n)continue;const s=t.width,o=t.height,r=t.xPosition,l=t.yPosition;if(s<=0||o<=0||r<0||l<0)continue;const d=t.staticResource,h=t.iframeResource,p=t.htmlResource;if(null===d&&null===h&&null===p)continue;const v={program:n,width:s,height:o,xPosition:r,yPosition:l,staticResourceUrl:d,iframeResourceUrl:h,htmlContent:p};v.iconViewTrackingUrl=t.iconViewTrackingURLTemplate,v.iconClickThroughUrl=t.iconClickThroughURLTemplate,v.iconClickTrackingUrls=t.iconClickTrackingURLTemplates,this.iconsData.push(v)}}},be=function(i,e){e&&(e.stopPropagation(),"touchend"===e.type&&e.preventDefault()),a.openWindow(this.iconsData[i].iconClickThroughUrl);const t=this.iconsData[i].iconClickTrackingUrls;t.length>0&&t.forEach(n=>{n.url&&E.pingURI.call(this,n.url)})},ct=function(i){E.pingURI.call(this,this.iconsData[i].iconViewTrackingUrl)},dt=function(){this.vastPlayer.removeEventListener("playing",this.onPlayingAppendIcons),this.iconsData.forEach((i,e)=>{let t,n;i.staticResourceUrl?(t=document.createElement("img"),n=i.staticResourceUrl):(i.iframeResourceUrl||i.htmlContent)&&(t=document.createElement("iframe"),t.sandbox="allow-scripts allow-same-origin",n=i.htmlContent?i.htmlContent:i.iframeResourceUrl,a.setStyle(t,{border:"none",overflow:"hidden"}),t.setAttribute("scrolling","no"),t.setAttribute("allow","autoplay; fullscreen; picture-in-picture; xr-spatial-tracking; encrypted-media"),t.setAttribute("sandbox","allow-scripts allow-presentation allow-same-origin")),t.className="rmp-ad-container-icons",a.setStyle(t,{width:parseInt(i.width)+"px",height:parseInt(i.height)+"px"});const s=i.xPosition;"left"===s?t.style.left="0px":"right"===s?t.style.right="0px":t.style.left=parseInt(s)>=0?s+"px":"0px";const o=i.yPosition;"top"===o?t.style.top="0px":"bottom"===s?t.style.bottom="0px":t.style.top=parseInt(o)>=0?o+"px":"0px",i.iconViewTrackingUrl&&(t.onload=ct.bind(this,e)),i.iconClickThroughUrl&&(t.addEventListener("touchend",be.bind(this,e)),t.addEventListener("click",be.bind(this,e))),i.htmlContent?t.srcdoc=n:t.src=n,this.adContainer.appendChild(t)})};Ee.append=function(){this.onPlayingAppendIcons=dt.bind(this),this.vastPlayer.addEventListener("playing",this.onPlayingAppendIcons)};var re=Ee;const O={getAdWidth:function(){return this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdWidth?this.vpaidCreative.getAdWidth():-1},getAdHeight:function(){return this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdHeight?this.vpaidCreative.getAdHeight():-1},getAdDuration:function(){if(this.vpaidCreative){if("function"==typeof this.vpaidCreative.getAdDuration)return this.vpaidCreative.getAdDuration();if(this.vpaid1AdDuration>-1)return this.vpaid1AdDuration}return-1},getAdRemainingTime:function(){return this.vpaidRemainingTime>=0?this.vpaidRemainingTime:-1},getCreativeUrl:function(){return this.vpaidCreativeUrl?this.vpaidCreativeUrl:""},getVpaidCreative:function(){return this.vpaidCreative},getAdVolume:function(){return this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdVolume?this.vpaidCreative.getAdVolume():null},getAdPaused:function(){return this.vpaidPaused},getAdExpanded:function(){return!(!this.vpaidCreative||"function"!=typeof this.vpaidCreative.getAdExpanded)&&this.vpaidCreative.getAdExpanded()},getAdSkippableState:function(){return!(!this.vpaidCreative||"function"!=typeof this.vpaidCreative.getAdSkippableState)&&this.vpaidCreative.getAdSkippableState()},getAdIcons:function(){return this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdIcons?this.vpaidCreative.getAdIcons():null},getAdCompanions:function(){return this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdCompanions?this.vpaidCreative.getAdCompanions():""}},ht=function(){this.vpaidAdLoaded=!0,this.vpaidCreative&&(this.initAdTimeout&&clearTimeout(this.initAdTimeout),this.vpaidCallbacks.AdLoaded&&this.vpaidCreative.unsubscribe(this.vpaidCallbacks.AdLoaded,"AdLoaded"),this.isFirstAd()||(this.startAdTimeout=setTimeout(()=>{this.vpaidAdStarted||L.resumeContent.call(this),this.vpaidAdStarted=!1},this.params.creativeLoadTimeout),a.show(this.adContainer),a.show(this.vastPlayer),this.vpaidCreative.startAd()),this.adOnStage=!0,u.createApiEvent.call(this,"adloaded"),E.dispatch.call(this,"loaded"))},ut=function(){this.vpaidAdStarted=!0,this.vpaidCreative&&(this.startAdTimeout&&clearTimeout(this.startAdTimeout),this.vpaidCallbacks.AdStarted&&this.vpaidCreative.unsubscribe(this.vpaidCallbacks.AdStarted,"AdStarted"),1===this.vpaidVersion&&(this.vpaid1AdDuration=O.getAdRemainingTime.call(this)),!O.getAdIcons.call(this)&&!this.useContentPlayerForAds&&this.iconsData.length>0&&re.append.call(this),"function"==typeof this.vpaidCreative.getAdLinear&&(this.creative.isLinear=this.vpaidCreative.getAdLinear()),E.dispatch.call(this,"creativeView"))},pe=function(){this.adStoppedTimeout&&clearTimeout(this.adStoppedTimeout),L.resumeContent.call(this)},pt=function(){this.adSkippedTimeout&&clearTimeout(this.adSkippedTimeout),u.createApiEvent.call(this,"adskipped"),E.dispatch.call(this,"skip")},vt=function(){u.createApiEvent.call(this,"adskippablestatechanged")},mt=function(){if(this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdRemainingTime){const i=this.vpaidCreative.getAdRemainingTime();i>=0&&(this.vpaidRemainingTime=i),clearInterval(this.vpaidAdRemainingTimeInterval),this.vpaidAdRemainingTimeInterval=setInterval(()=>{const e=this.vpaidCreative.getAdRemainingTime();e>=0&&(this.vpaidRemainingTime=e)},200),u.createApiEvent.call(this,"addurationchange")}},gt=function(){const i=O.getAdVolume.call(this);null!==i&&(this.vpaidCurrentVolume>0&&0===i?E.dispatch.call(this,"mute"):0===this.vpaidCurrentVolume&&i>0&&E.dispatch.call(this,"unmute"),this.vpaidCurrentVolume=i,u.createApiEvent.call(this,"advolumechanged"))},At=function(){u.createApiEvent.call(this,"adimpression"),E.dispatch.call(this,"impression")},ft=function(){this.vpaidPaused=!1;let i=O.getAdVolume.call(this);null===i&&(i=1),this.vpaidCurrentVolume=i,u.createApiEvent.call(this,"adstarted"),E.dispatch.call(this,"start")},yt=function(){u.createApiEvent.call(this,"adfirstquartile"),E.dispatch.call(this,"firstQuartile")},Tt=function(){u.createApiEvent.call(this,"admidpoint"),E.dispatch.call(this,"midpoint")},Ct=function(){u.createApiEvent.call(this,"adthirdquartile"),E.dispatch.call(this,"thirdQuartile")},Et=function(){u.createApiEvent.call(this,"adcomplete"),E.dispatch.call(this,"complete")},bt=function(i,e,t){if(E.dispatch.call(this,"clickthrough"),"boolean"==typeof t)if(t){{let n;i?n=i:this.creative.clickThroughUrl&&(n=this.creative.clickThroughUrl),n&&(this.creative.clickThroughUrl=n,a.openWindow(this.creative.clickThroughUrl))}u.createApiEvent.call(this,"adclick")}else u.createApiEvent.call(this,"adclick");else u.createApiEvent.call(this,"adclick")},kt=function(){this.vpaidPaused=!0,u.createApiEvent.call(this,"adpaused"),E.dispatch.call(this,"pause")},Pt=function(){this.vpaidPaused=!1,u.createApiEvent.call(this,"adresumed"),E.dispatch.call(this,"resume")},Lt=function(i){},St=function(i){u.processVastErrors.call(this,901,!0)},It=function(){u.createApiEvent.call(this,"adinteraction")},Rt=function(){u.createApiEvent.call(this,"aduseracceptinvitation"),E.dispatch.call(this,"acceptInvitation")},wt=function(){u.createApiEvent.call(this,"adcollapse"),E.dispatch.call(this,["collapse","adCollapse"])},Nt=function(){u.createApiEvent.call(this,"adclosed"),E.dispatch.call(this,"close")},Ut=function(){u.createApiEvent.call(this,"adsizechange")},xt=function(){this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdLinear&&(this.creative.isLinear=this.vpaidCreative.getAdLinear(),u.createApiEvent.call(this,"adlinearchange"))},Vt=function(){u.createApiEvent.call(this,"adexpandedchange")},Dt=function(){if(this.vpaidCreative&&"function"==typeof this.vpaidCreative.getAdRemainingTime){const i=this.vpaidCreative.getAdRemainingTime();i>=0&&(this.vpaidRemainingTime=i),u.createApiEvent.call(this,"adremainingtimechange")}};O.resizeAd=function(i,e,t){if(!this.vpaidCreative||!a.isNumber(i)||!a.isNumber(e)||"string"!=typeof t||i<=0||e<=0)return;let n="normal";"fullscreen"===t&&(n=t),this.vpaidCreative.resizeAd(i,e,n)},O.stopAd=function(){this.vpaidCreative&&(this.adStoppedTimeout=setTimeout(()=>{pe.call(this)},this.params.creativeLoadTimeout),this.vpaidCreative.stopAd())},O.pauseAd=function(){this.vpaidCreative&&!this.vpaidPaused&&this.vpaidCreative.pauseAd()},O.resumeAd=function(){return this.vpaidCreative&&(a.show(this.adContainer),a.show(this.vastPlayer),this.vpaidPaused?this.vpaidCreative.resumeAd():(this.startAdTimeout=setTimeout(()=>{this.vpaidAdStarted||L.resumeContent.call(this),this.vpaidAdStarted=!1},this.params.creativeLoadTimeout),this.vpaidCreative.startAd())),Promise.resolve()},O.expandAd=function(){this.vpaidCreative&&this.vpaidCreative.expandAd()},O.collapseAd=function(){this.vpaidCreative&&this.vpaidCreative.collapseAd()},O.skipAd=function(){this.vpaidCreative&&(this.adSkippedTimeout=setTimeout(()=>{pe.call(this)},this.params.creativeLoadTimeout),this.vpaidCreative.skipAd())},O.setAdVolume=function(i){this.vpaidCreative&&a.isNumber(i)&&i>=0&&i<=1&&"function"==typeof this.vpaidCreative.setAdVolume&&this.vpaidCreative.setAdVolume(i)};const Ot=function(){this.vpaidCreative&&(this.vpaidCallbacks={AdLoaded:ht.bind(this),AdStarted:ut.bind(this),AdStopped:pe.bind(this),AdSkipped:pt.bind(this),AdSkippableStateChange:vt.bind(this),AdDurationChange:mt.bind(this),AdVolumeChange:gt.bind(this),AdImpression:At.bind(this),AdVideoStart:ft.bind(this),AdVideoFirstQuartile:yt.bind(this),AdVideoMidpoint:Tt.bind(this),AdVideoThirdQuartile:Ct.bind(this),AdVideoComplete:Et.bind(this),AdClickThru:bt.bind(this),AdPaused:kt.bind(this),AdPlaying:Pt.bind(this),AdLog:Lt.bind(this),AdError:St.bind(this),AdInteraction:It.bind(this),AdUserAcceptInvitation:Rt.bind(this),AdUserMinimize:wt.bind(this),AdUserClose:Nt.bind(this),AdSizeChange:Ut.bind(this),AdLinearChange:xt.bind(this),AdExpandedChange:Vt.bind(this),AdRemainingTimeChange:Dt.bind(this)},Object.keys(this.vpaidCallbacks).forEach(i=>{this.vpaidCreative.subscribe(this.vpaidCallbacks[i],i)}))},Mt=function(){this.vpaidCreative&&Object.keys(this.vpaidCallbacks).forEach(i=>{this.vpaidCreative.unsubscribe(this.vpaidCallbacks[i],i)})},ke=function(){if(this.vpaidAvailableInterval&&clearInterval(this.vpaidAvailableInterval),this.vpaidLoadTimeout&&clearTimeout(this.vpaidLoadTimeout),this.vpaidCreative=this.vpaidIframe.contentWindow.getVPAIDAd(),this.vpaidCreative&&"function"==typeof this.vpaidCreative.handshakeVersion){let e;try{e=this.vpaidCreative.handshakeVersion("2.0")}catch{return void u.processVastErrors.call(this,901,!0)}if(this.vpaidVersion=parseInt(e),this.vpaidVersion<1)return void u.processVastErrors.call(this,901,!0);if("function"!=typeof(i=this.vpaidCreative).initAd||"function"!=typeof i.startAd||"function"!=typeof i.stopAd||"function"!=typeof i.skipAd||"function"!=typeof i.resizeAd||"function"!=typeof i.pauseAd||"function"!=typeof i.resumeAd||"function"!=typeof i.expandAd||"function"!=typeof i.collapseAd||"function"!=typeof i.subscribe||"function"!=typeof i.unsubscribe)return void u.processVastErrors.call(this,901,!0);Ot.call(this),E.wire.call(this);const t={};t.AdParameters=this.adParametersData;const n={};this.vpaidSlot=document.createElement("div"),this.vpaidSlot.className="rmp-vpaid-container",this.adContainer.appendChild(this.vpaidSlot),n.slot=this.vpaidSlot,n.videoSlot=this.vastPlayer,n.videoSlotCanAutoPlay=!0,this.initAdTimeout=setTimeout(()=>{this.vpaidAdLoaded||L.resumeContent.call(this),this.vpaidAdLoaded=!1},10*this.params.creativeLoadTimeout),this.vpaidCreative.initAd(this.initialWidth,this.initialHeight,this.initialViewMode,this.desiredBitrate,t,n)}var i},Ft=function(){const i=this.vpaidIframe.contentWindow;"function"==typeof i.getVPAIDAd?ke.call(this):this.vpaidAvailableInterval=setInterval(()=>{"function"==typeof i.getVPAIDAd&&ke.call(this)},100),this.vpaidScript.onload=null,this.vpaidScript.onerror=null},Bt=function(){u.processVastErrors.call(this,901,!0),this.vpaidScript.onload=null,this.vpaidScript.onerror=null};O.loadCreative=function(i,e){if(this.initialWidth=e.width,this.initialHeight=e.height,this.initialViewMode=e.viewMode,this.desiredBitrate=e.desiredBitrate,this.vpaidCreativeUrl=i,!this.vastPlayer)if(this.useContentPlayerForAds)this.vastPlayer=this.contentPlayer;else{let t=null;if(this.adContainer&&(t=this.adContainer.querySelector(".rmp-ad-vast-video-player")),null===t)return void u.processVastErrors.call(this,900,!0);this.vastPlayer=t}D.pause.call(this),this.vpaidIframe=document.createElement("iframe"),this.vpaidIframe.id="vpaid-frame",a.setStyle(this.vpaidIframe,{visibility:"hidden",width:"0px",height:"0px",border:"none"}),this.vpaidIframe.onload=function(){if(this.vpaidIframe.onload=this.vpaidIframe.onerror=a.nullFn,!this.vpaidIframe.contentWindow||!this.vpaidIframe.contentWindow.document||!this.vpaidIframe.contentWindow.document.body)return void u.processVastErrors.call(this,901,!0);const t=this.vpaidIframe.contentWindow.document,n=t.body;this.vpaidScript=t.createElement("script"),this.vpaidLoadTimeout=setTimeout(()=>{this.vpaidScript.onload=null,this.vpaidScript.onerror=null,L.resumeContent.call(this)},this.params.creativeLoadTimeout),this.vpaidScript.onload=Ft.bind(this),this.vpaidScript.onerror=Bt.bind(this),n.appendChild(this.vpaidScript),this.vpaidScript.src=this.vpaidCreativeUrl}.bind(this),this.vpaidIframe.onerror=function(){this.vpaidIframe.onload=this.vpaidIframe.onerror=a.nullFn,u.processVastErrors.call(this,901,!0)}.bind(this),this.vpaidIframe.src="about:blank",(e.vpaidIFrameSlot||this.adContainer).appendChild(this.vpaidIframe)},O.destroy=function(){this.vpaidAvailableInterval&&clearInterval(this.vpaidAvailableInterval),this.vpaidAdRemainingTimeInterval&&clearInterval(this.vpaidAdRemainingTimeInterval),this.vpaidLoadTimeout&&clearTimeout(this.vpaidLoadTimeout),this.initAdTimeout&&clearTimeout(this.initAdTimeout),this.startAdTimeout&&clearTimeout(this.startAdTimeout),this.adStoppedTimeout&&clearTimeout(this.adStoppedTimeout),Mt.call(this),this.vpaidScript&&(this.vpaidScript.onload=null,this.vpaidScript.onerror=null),this.vpaidSlot&&a.removeElement(this.vpaidSlot),this.vpaidIframe&&a.removeElement(this.vpaidIframe)};var w=O;const oe={},Wt=function(){u.processVastErrors.call(this,502,!0)},qt=function(){this.adOnStage=!0,u.createApiEvent.call(this,["adloaded","adimpression","adstarted"]),E.dispatch.call(this,["impression","creativeView","start","loaded"])},Ht=function(i){try{i&&i.stopPropagation(),this.pause(),u.createApiEvent.call(this,"adclick"),E.dispatch.call(this,"clickthrough")}catch{}},jt=function(i){i&&(i.stopPropagation(),"touchend"===i.type&&i.preventDefault()),a.setStyle(this.nonLinearContainer,{display:"none"}),u.createApiEvent.call(this,"adclosed"),E.dispatch.call(this,"close")},_t=function(){this.nonLinearClose=document.createElement("div"),this.nonLinearClose.className="rmp-ad-non-linear-close",u.makeButtonAccessible(this.nonLinearClose,this.params.labels.closeAd),this.nonLinearMinSuggestedDuration>0?(a.setStyle(this.nonLinearClose,{display:"none"}),setTimeout(()=>{a.setStyle(this.nonLinearClose,{display:"block"})},1e3*this.nonLinearMinSuggestedDuration)):a.setStyle(this.nonLinearClose,{display:"block"}),this.onClickCloseNonLinear=jt.bind(this),this.nonLinearClose.addEventListener("touchend",this.onClickCloseNonLinear),this.nonLinearClose.addEventListener("click",this.onClickCloseNonLinear),this.nonLinearContainer.appendChild(this.nonLinearClose)};oe.update=function(){this.nonLinearContainer=document.createElement("div"),this.nonLinearContainer.className="rmp-ad-non-linear-container",a.setStyle(this.nonLinearContainer,{width:this.creative.width.toString()+"px",height:this.creative.height.toString()+"px"}),this.nonLinearATag=document.createElement("a"),this.nonLinearATag.className="rmp-ad-non-linear-anchor",this.creative.clickThroughUrl&&(this.nonLinearATag.href=this.creative.clickThroughUrl,this.nonLinearATag.target="_blank",this.onNonLinearClickThrough=Ht.bind(this),this.nonLinearATag.addEventListener(m.isMobile?"touchend":"click",this.onNonLinearClickThrough)),"image"===this.creative.nonLinearType?this.nonLinearInnerElement=document.createElement("img"):(this.nonLinearInnerElement=document.createElement("iframe"),this.nonLinearInnerElement.sandbox="allow-scripts allow-same-origin",a.setStyle(this.nonLinearInnerElement,{border:"none",overflow:"hidden"}),this.nonLinearInnerElement.setAttribute("allow","autoplay; fullscreen; picture-in-picture; xr-spatial-tracking; encrypted-media"),this.nonLinearInnerElement.setAttribute("scrolling","no"),this.nonLinearInnerElement.setAttribute("sandbox","allow-scripts allow-presentation allow-same-origin")),this.nonLinearInnerElement.className="rmp-ad-non-linear-creative",this.onNonLinearLoadError=Wt.bind(this),this.nonLinearInnerElement.addEventListener("error",this.onNonLinearLoadError),this.onNonLinearLoadSuccess=qt.bind(this),this.nonLinearInnerElement.addEventListener("load",this.onNonLinearLoadSuccess),"html"===this.creative.nonLinearType?this.nonLinearInnerElement.srcdoc=this.creative.mediaUrl:this.nonLinearInnerElement.src=this.creative.mediaUrl,this.isFirstAd()||this.play()},oe.parse=function(i){let e,t=!1;for(let n=0;n<i.length;n++){t=!1,e=i[n];let s=e.width,o=e.height;if(s<=0&&(s=300),o<=0&&(o=44),s>a.getWidth(this.container)||o>a.getHeight(this.container)){t=!0;continue}this.nonLinearMinSuggestedDuration=e.minSuggestedDuration;const r=e.staticResource,l=e.iframeResource,d=e.htmlResource;if(null!==r||null!==l||null!==d){r?(this.creative.mediaUrl=r,this.creative.nonLinearType="image"):l?(this.creative.mediaUrl=l,this.creative.nonLinearType="iframe"):d&&(this.creative.mediaUrl=d,this.creative.nonLinearType="html"),this.creative.width=s,this.creative.height=o,this.creative.type=e.type;break}}if(!this.creative.mediaUrl||t){let n=503;return t&&(n=501),void u.processVastErrors.call(this,n,!0)}this.creative.clickThroughUrl=e.nonlinearClickThroughURLTemplate,e.nonlinearClickTrackingURLTemplates.length>0&&e.nonlinearClickTrackingURLTemplates.forEach(n=>{n.url&&this.trackingTags.push({event:"clickthrough",url:n.url})}),L.append.call(this)},oe.play=function(){return this.nonLinearATag.appendChild(this.nonLinearInnerElement),this.nonLinearContainer.appendChild(this.nonLinearATag),this.adContainer.appendChild(this.nonLinearContainer),_t.call(this),a.show(this.adContainer),Promise.resolve()};var ve=oe;class Jt{constructor(){}_getConnectionType(){if("string"==typeof navigator.connection.type&&""!==navigator.connection.type)switch(navigator.connection.type){case"ethernet":return"ethernet";case"wifi":case"wimax":return"wifi";case"bluetooth":case"cellular":return"cellular";case"none":return"none"}return"unknown"}_getBandwidthEstimate(){if("number"==typeof navigator.connection.downlink&&navigator.connection.downlink>0)return navigator.connection.downlink;if("string"==typeof navigator.connection.effectiveType&&""!==navigator.connection.effectiveType)switch(navigator.connection.effectiveType){case"slow-2g":return.025;case"2g":return.035;case"3g":return.35;case"4g":return 1.4}else if("string"==typeof navigator.connection.type&&""!==navigator.connection.type)switch(navigator.connection.type){case"ethernet":case"wifi":case"wimax":return 1.4;case"bluetooth":case"cellular":return.35;case"none":return-1}return.025}get bandwidthData(){return void 0===navigator.onLine||navigator.onLine?void 0===navigator.connection?{estimate:-1,connectionType:"unknown"}:{estimate:this._getBandwidthEstimate(),connectionType:this._getConnectionType()}:{estimate:-1,connectionType:"none"}}}const me={},Gt=/vpaid/i,zt=/\/javascript/i,ge=["video/webm","video/mp4","video/ogg","video/3gpp"],Yt=function(){this.vastPlayerDuration=L.getDuration.call(this),u.createApiEvent.call(this,"addurationchange"),-1!==this.vastPlayerDuration&&(Object.keys(this.creative.trackingEvents).forEach(i=>{if(/progress-/i.test(i)){const e=i.split("-")[1];if(/%/i.test(e)){let t=e.slice(0,-1);t=this.vastPlayerDuration*parseFloat(t)/100,this.creative.trackingEvents[i].forEach(n=>{this.progressEvents.push({time:t,url:n})})}else this.creative.trackingEvents[i].forEach(t=>{this.progressEvents.push({time:1e3*parseFloat(e),url:t})})}}),this.progressEvents.length>0&&this.progressEvents.sort(function(i,e){return i.time-e.time}))},Kt=function(){clearTimeout(this.creativeLoadTimeoutCallback),this.adOnStage=!0,this.isFirstAd()||L.play.call(this),u.createApiEvent.call(this,"adloaded"),E.dispatch.call(this,"loaded")},Xt=function(i){i&&i.stopPropagation(),m.isMobile||a.openWindow(this.creative.clickThroughUrl),u.createApiEvent.call(this,"adclick"),E.dispatch.call(this,"clickthrough")},Qt=function(i){if(i&&i.target){const e=i.target;if(e.error&&a.isNumber(e.error.code)){const t=e.error.code;let n="";"string"==typeof e.error.message&&(n=e.error.message),t.toString(),4===t&&u.processVastErrors.call(this,401,!0)}}},$t=function(){this.clickUIOnMobile=document.createElement("a"),this.clickUIOnMobile.className="rmp-ad-click-ui-mobile",this.clickUIOnMobile.textContent=this.params.labels.textForClickUIOnMobile,this.clickUIOnMobile.addEventListener("touchend",this.onClickThrough),this.clickUIOnMobile.href=this.creative.clickThroughUrl,this.clickUIOnMobile.target="_blank",this.adContainer.appendChild(this.clickUIOnMobile)},Zt=function(i){i&&(i.stopPropagation(),i.preventDefault())},ei=function(){a.hide(this.skipWaiting),a.show(this.skipMessage),a.show(this.skipIcon)},Pe=function(i){Math.round(i)>0&&(this.skipWaiting.textContent=this.params.labels.skipMessage(i))},ti=function(){this.vastPlayer.duration<this.creative.skipoffset?a.hide(this.skipButton):(a.hidden(this.skipButton)&&a.show(this.skipButton),this.vastPlayerCurrentTime=this.vastPlayer.currentTime,a.isNumber(this.vastPlayerCurrentTime)&&this.vastPlayerCurrentTime>0&&(this.vastPlayerCurrentTime>=this.creative.skipoffset?(this.vastPlayer.removeEventListener("timeupdate",this.onTimeupdateCheckSkip),this.vastPlayer.removeEventListener("canplay",this.onTimeupdateCheckSkip),this.vastPlayer.removeEventListener("durationchange",this.onTimeupdateCheckSkip),ei.call(this),this.skippableAdCanBeSkipped=!0,u.createApiEvent.call(this,"adskippablestatechanged")):this.creative.skipoffset-this.vastPlayerCurrentTime>0&&Pe.call(this,this.creative.skipoffset-this.vastPlayerCurrentTime)))},ii=function(i){i&&(i.stopPropagation(),"touchend"===i.type&&i.preventDefault()),this.skippableAdCanBeSkipped&&(u.createApiEvent.call(this,"adskipped"),E.dispatch.call(this,"skip"),L.resumeContent.call(this))},ni=function(){this.skipButton=document.createElement("div"),this.skipButton.className="rmp-ad-container-skip",a.hide(this.skipButton),u.makeButtonAccessible(this.skipButton,this.params.labels.skipMessage(-1)),this.skipWaiting=document.createElement("div"),this.skipWaiting.className="rmp-ad-container-skip-waiting",Pe.call(this,this.creative.skipoffset),a.show(this.skipWaiting),this.skipMessage=document.createElement("div"),this.skipMessage.className="rmp-ad-container-skip-message",this.skipMessage.textContent=this.params.labels.skipMessage(-1),a.hide(this.skipMessage),this.skipIcon=document.createElement("div"),this.skipIcon.className="rmp-ad-container-skip-icon",a.hide(this.skipIcon),this.onClickSkip=ii.bind(this),this.skipButton.addEventListener("click",this.onClickSkip),this.skipButton.addEventListener("touchend",this.onClickSkip),this.skipButton.appendChild(this.skipWaiting),this.skipButton.appendChild(this.skipMessage),this.skipButton.appendChild(this.skipIcon),this.adContainer.appendChild(this.skipButton),this.onTimeupdateCheckSkip=ti.bind(this),this.vastPlayer.addEventListener("canplay",this.onTimeupdateCheckSkip),this.vastPlayer.addEventListener("durationchange",this.onTimeupdateCheckSkip),this.vastPlayer.addEventListener("timeupdate",this.onTimeupdateCheckSkip)},ai=function(i,e){if(e.fatal)switch(e.type){case Hls.ErrorTypes.NETWORK_ERROR:this.hlsJS[this.hlsJSIndex].startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:this.hlsJS[this.hlsJSIndex].recoverMediaError();break;default:u.processVastErrors.call(this,900,!0)}};me.update=function(i,e){this.onDurationChange=Yt.bind(this),this.vastPlayer.addEventListener("durationchange",this.onDurationChange,{once:!0}),this.onLoadedmetadataPlay=Kt.bind(this),this.vastPlayer.addEventListener("loadedmetadata",this.onLoadedmetadataPlay,{once:!0}),this.onContextMenu=Zt.bind(this),this.vastPlayer.addEventListener("contextmenu",this.onContextMenu),this.onPlaybackError=Qt.bind(this),this.creativeLoadTimeoutCallback=setTimeout(()=>{u.processVastErrors.call(this,402,!0)},this.params.creativeLoadTimeout),this.useContentPlayerForAds?(this.contentPlayer.addEventListener("error",this.onPlaybackError),this.contentPlayer.src=i):this.params.useHlsJS&&"application/vnd.apple.mpegurl"===e&&void 0!==window.Hls&&Hls.isSupported()?(this.readingHlsJS=!0,this.hlsJS[this.hlsJSIndex]=new Hls({autoStartLoad:!0,debug:this.params.debugHlsJS,capLevelToPlayerSize:!0,testBandwidth:!0,progressive:!1,lowLatencyMode:!1,enableWebVTT:!1,enableIMSC1:!1,enableCEA708Captions:!1}),this.hlsJS[this.hlsJSIndex].on(Hls.Events.ERROR,ai.bind(this)),this.hlsJS[this.hlsJSIndex].loadSource(i),this.hlsJS[this.hlsJSIndex].attachMedia(this.vastPlayer)):(this.vastPlayer.addEventListener("error",this.onPlaybackError),this.vastPlayer.src=i,this.vastPlayer.load()),this.onClickThrough=Xt.bind(this),this.creative.clickThroughUrl&&((m.isMobile||this.params.alwaysShowMoreButton)&&$t.call(this),m.isMobile||this.vastPlayer.addEventListener("click",this.onClickThrough)),this.creative.isSkippableAd&&ni.call(this)},me.parse=function(i,e,t){i.length>0&&re.parse.call(this,i),this.adParametersData="",null!==e&&(this.adParametersData=e);let n=[];for(let p=0;p<t.length;p++){const v=t[p],g=v.fileURL,y=v.mimeType;if(null===g||null===y)continue;const b={};if(b.url=g,b.type=y,null!==v.codec&&(b.codec=v.codec),this.params.enableVpaid&&v.apiFramework&&Gt.test(v.apiFramework)&&zt.test(y)){n=[b],this.isVPAID=!0;break}b.width=v.width,b.height=v.height,b.bitrate=v.bitrate,n.push(b)}const s=[];for(let p=0;p<n.length;p++){const v=n[p],g=v.type,y=v.url;if(this.isVPAID&&y)return w.loadCreative.call(this,y,this.params.vpaidSettings),void(this.creative.type=g);if("application/vnd.apple.mpegurl"===g&&(m.checkCanPlayType(g)||void 0!==window.Hls&&Hls.isSupported()))return L.append.call(this,y,g),void(this.creative.type=g);if(m.checkCanPlayType("application/dash+xml"))return L.append.call(this,y,g),void(this.creative.type=g);s.push(v)}let o=[];const r=function(p,v){return v.codec&&v.type===ge[p]?m.checkCanPlayType(v.type,v.codec):v.type===ge[p]&&m.checkCanPlayType(v.type)};for(let p=0;p<ge.length&&(o=s.filter(r.bind(null,p)),!(o.length>0));p++);if(0===o.length){const p=function(v,g,y){return y.codec===v&&y.type===g};s.forEach(v=>{v.codec&&v.type&&m.checkCanPlayType(v.type,v.codec)&&(o=s.filter(p.bind(null,v.codec,v.type)))})}if(0===o.length){const p=function(v,g){return g.type===v};s.forEach(v=>{v.type&&m.checkCanPlayType(v.type)&&(o=s.filter(p.bind(null,v.type)))})}if(0===o.length)return void u.processVastErrors.call(this,403,!0);let l;o.sort((p,v)=>p.width-v.width);let d=[],h=[];if(o.length>1){const p=a.getWidth(this.container)*m.devicePixelRatio,v=a.getHeight(this.container)*m.devicePixelRatio;p>0&&v>0&&(d=o.filter(y=>p>=y.width&&v>=y.height)),0===d.length&&(d=[o[0]]);let g=(new Jt).bandwidthData.estimate;g>-1&&d.length>1&&(d.sort((y,b)=>y.bitrate-b.bitrate),g=Math.round(1e3*g),h=d.filter(y=>g>=y.bitrate),l=h[h.length-1])}l||(d.length>0?l=d[d.length-1]:(o.sort((p,v)=>p.bitrate-v.bitrate),l=o[o.length-1])),this.creative.mediaUrl=l.url,this.creative.height=l.height,this.creative.width=l.width,this.creative.type=l.type,L.append.call(this,l.url,l.type)};var Le=me;const F={},si=function(){this.nonLinearContainer&&(this.nonLinearInnerElement.removeEventListener("load",this.onNonLinearLoadSuccess),this.nonLinearInnerElement.removeEventListener("error",this.onNonLinearLoadError),this.nonLinearATag.removeEventListener("click",this.onNonLinearClickThrough),this.nonLinearATag.removeEventListener("touchend",this.onNonLinearClickThrough),this.nonLinearClose.removeEventListener("click",this.onClickCloseNonLinear),this.nonLinearClose.removeEventListener("touchend",this.onClickCloseNonLinear),this.trackingTags.forEach(i=>{this.nonLinearContainer.removeEventListener(i.event,this.onEventPingTracking)})),this.vastPlayer&&(this.vastPlayer.removeEventListener("error",this.onPlaybackError),this.vastPlayer.removeEventListener("durationchange",this.onDurationChange),this.vastPlayer.removeEventListener("loadedmetadata",this.onLoadedmetadataPlay),this.vastPlayer.removeEventListener("contextmenu",this.onContextMenu),this.vastPlayer.removeEventListener("pause",this.onPause),this.vastPlayer.removeEventListener("play",this.onPlay),this.vastPlayer.removeEventListener("playing",this.onPlaying),this.vastPlayer.removeEventListener("ended",this.onEnded),this.vastPlayer.removeEventListener("volumechange",this.onVolumeChange),this.vastPlayer.removeEventListener("timeupdate",this.onTimeupdate),this.trackingTags.forEach(i=>{this.vastPlayer.removeEventListener(i.event,this.onEventPingTracking)}),this.vastPlayer.removeEventListener("click",this.onClickThrough),this.vastPlayer.removeEventListener("playing",this.onPlayingAppendIcons),this.vastPlayer.removeEventListener("timeupdate",this.onTimeupdateCheckSkip)),this.skipButton&&(this.skipButton.removeEventListener("click",this.onClickSkip),this.skipButton.removeEventListener("touchend",this.onClickSkip)),this.clickUIOnMobile&&this.clickUIOnMobile.removeEventListener("touchend",this.onClickThrough),this.contentPlayer&&this.contentPlayer.removeEventListener("error",this.onPlaybackError)};F.destroy=function(){if(this.iconsData.length>0&&re.destroy.call(this),this.isVPAID&&w.destroy.call(this),si.call(this),this.clickUIOnMobile&&a.removeElement(this.clickUIOnMobile),this.creative.isSkippableAd&&(a.removeElement(this.skipButton),this.vastPlayer.removeEventListener("timeupdate",this.onTimeupdateCheckSkip),this.vastPlayer.removeEventListener("canplay",this.onTimeupdateCheckSkip),this.vastPlayer.removeEventListener("durationchange",this.onTimeupdateCheckSkip)),a.hide(this.adContainer),clearInterval(this.antiSeekLogicInterval),clearTimeout(this.creativeLoadTimeoutCallback),this.useContentPlayerForAds)if(this.params.outstream)try{this.contentPlayer&&(this.contentPlayer.pause(),this.contentPlayer.removeAttribute("src"),this.contentPlayer.load())}catch{}else this.nonLinearContainer?a.removeElement(this.nonLinearContainer):(this.currentContentCurrentTime>4e3&&(this.needsSeekAdjust=!0,this.contentPlayerCompleted&&(this.needsSeekAdjust=!1),this.seekAdjustAttached||(this.seekAdjustAttached=!0,this.contentPlayer.addEventListener("playing",()=>{this.needsSeekAdjust&&(this.needsSeekAdjust=!1,D.seekTo.call(this,this.currentContentCurrentTime))}))),this.contentPlayer.src=this.currentContentSrc);else try{this.vastPlayer&&(this.vastPlayer.pause(),this.readingHlsJS?(this.readingHlsJS=!1,this.hlsJS[this.hlsJSIndex].destroy(),this.hlsJSIndex++):(this.vastPlayer.removeAttribute("src"),this.vastPlayer.load()),a.hide(this.vastPlayer)),this.nonLinearContainer&&a.removeElement(this.nonLinearContainer)}catch{}u.resetVariablesForNewLoadAds.call(this),u.createApiEvent.call(this,"addestroyed")},F.init=function(){this.adContainer=document.createElement("div"),this.adContainer.className="rmp-ad-container",a.hide(this.adContainer),this.contentWrapper.appendChild(this.adContainer),this.useContentPlayerForAds?this.vastPlayer=this.contentPlayer:(this.vastPlayer=document.createElement("video"),a.logVideoEvents(this.vastPlayer,"vast"),m.isAndroid[0]&&void 0!==this.vastPlayer.disableRemotePlayback&&(this.vastPlayer.disableRemotePlayback=!0),this.vastPlayer.className="rmp-ad-vast-video-player",this.vastPlayer.controls=!!this.params.showControlsForVastPlayer,this.contentPlayer.hasAttribute("muted")&&(this.contentPlayer.muted=!0),this.contentPlayer.muted&&(this.vastPlayer.muted=!0),this.vastPlayer.poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=",this.vastPlayer.setAttribute("controlslist","nodownload"),this.vastPlayer.setAttribute("playsInline",!0),this.vastPlayer.defaultPlaybackRate=1,a.hide(this.vastPlayer),this.adContainer.appendChild(this.vastPlayer)),this.contentPlayer.addEventListener("ended",()=>{this.adOnStage||(this.contentPlayerCompleted=!0)}),this.vastPlayer.preload="auto",this.vastPlayer.load(),this.rmpVastInitialized=!0},F.append=function(i,e){if(!this.vastPlayer)if(this.useContentPlayerForAds)this.vastPlayer=this.contentPlayer;else{let t=null;if(this.adContainer&&(t=this.adContainer.querySelector(".rmp-ad-vast-video-player")),null===t)return void u.processVastErrors.call(this,900,!0);this.vastPlayer=t}if(this.creative.isLinear)i&&e&&Le.update.call(this,i,e);else{if(this.params.outstream)return void u.processVastErrors.call(this,201,!0);ve.update.call(this)}E.wire.call(this),!this.useContentPlayerForAds&&this.iconsData.length>0&&re.append.call(this)},F.setVolume=function(i){this.vastPlayer&&(this.vastPlayer.volume=i)},F.getVolume=function(){return this.vastPlayer?this.vastPlayer.volume:-1},F.setMute=function(i){this.vastPlayer&&(i&&!this.vastPlayer.muted?this.vastPlayer.muted=!0:!i&&this.vastPlayer.muted&&(this.vastPlayer.muted=!1))},F.getMute=function(){return!!this.vastPlayer&&this.vastPlayer.muted},F.play=function(i){return this.vastPlayer?this.vastPlayer.paused?u.playPromise.call(this,"vast",i).then(()=>{a.show(this.adContainer),a.show(this.vastPlayer),this.firstVastPlayerPlayRequest&&(this.firstVastPlayerPlayRequest=!1)}):Promise.resolve():Promise.reject("no vast player")},F.pause=function(){this.vastPlayer&&!this.vastPlayer.paused&&this.vastPlayer.pause()},F.getDuration=function(){if(this.vastPlayer){const i=this.vastPlayer.duration;if(a.isNumber(i))return Math.round(1e3*i)}return-1},F.getCurrentTime=function(){if(this.vastPlayer){const i=this.vastPlayer.currentTime;if(a.isNumber(i))return Math.round(1e3*i)}return-1},F.resumeContent=function(){this.isLastAd()&&u.createApiEvent.call(this,"adblockfinished"),F.destroy.call(this),this.readingHlsJS=!1,this.contentPlayerCompleted=!1};var L=F;const ri=[303,900,1001],oi=[201,204,205,400,401,402,403,501,502,503,603,901,1002],li=[{code:201,description:"Video player expecting different linearity."},{code:204,description:"Ad category was required but not provided."},{code:205,description:"Inline Category violates Wrapper BlockedAdCategories."},{code:303,description:"No VAST response after one or more Wrappers."},{code:400,description:"General Linear error. Video player is unable to display the Linear Ad."},{code:401,description:"File not found. Unable to find Linear/MediaFile from URI."},{code:402,description:"Timeout of MediaFile URI."},{code:403,description:"Couldn't find MediaFile that is supported by this video player, based on the attributes of the MediaFile element."},{code:501,description:"Unable to display NonLinear Ad because creative dimensions do not align with creative display area (i.e. creative dimension too large)."},{code:502,description:"Unable to fetch NonLinearAds/NonLinear resource."},{code:503,description:"Couldn't find NonLinear resource with supported type."},{code:603,description:"Unable to fetch CompanionAds/Companion resource."},{code:900,description:"Undefined Error."},{code:901,description:"General VPAID error."},{code:1001,description:"Invalid input for loadAds method"},{code:1002,description:"Required DOMParser API is not available"}];class u{static filterParams(e){this.params={ajaxTimeout:5e3,creativeLoadTimeout:8e3,ajaxWithCredentials:!1,maxNumRedirects:4,alwaysShowMoreButton:!1,labels:{skipMessage:"Skip ad",closeAd:"Close ad",textForClickUIOnMobile:"Learn more"},outstream:!1,showControlsForVastPlayer:!1,vastXmlInput:!1,enableVpaid:!0,vpaidSettings:{width:640,height:360,viewMode:"normal",desiredBitrate:500},useHlsJS:!1,debugHlsJS:!1,forceUseContentPlayerForAds:!1,omidSupport:!1,omidAllowedVendors:[],omidUnderEvaluation:!1,omidRunValidationScript:!1,omidAutoplay:!1,partnerName:"rmp-vast",partnerVersion:"11.0.3-patch5"},e&&"object"==typeof e&&Object.keys(e).forEach(t=>{typeof e[t]==typeof this.params[t]&&(a.isNumber(e[t])&&e[t]>0||"number"!=typeof e[t])&&(this.params[t]=e[t])})}static createApiEvent(e){Array.isArray(e)?e.forEach(t=>{t&&this.dispatch(t)}):e&&this.dispatch(e)}static playPromise(e,t){let n;switch(e){case"content":n=this.contentPlayer;break;case"vast":n=this.vastPlayer}if(!n)return Promise.reject("which player is wrong");const s=n.play();return void 0===s?Promise.resolve():s.then(()=>{t&&u.createApiEvent.call(this,"adinitialplayrequestsucceeded")}).catch(o=>{throw t&&"vast"===e&&this.creative.isLinear?(u.processVastErrors.call(this,400,!0),u.createApiEvent.call(this,"adinitialplayrequestfailed")):t&&"content"===e&&!this.creative.isLinear&&u.createApiEvent.call(this,"adinitialplayrequestfailed"),o})}static makeButtonAccessible(e,t){e.tabIndex=0,e.setAttribute("role","button"),e.addEventListener("keyup",n=>{const s=n.which;13!==s&&32!==s||(n.stopPropagation(),n.preventDefault(),a.createSyntheticEvent("click",e))}),t&&e.setAttribute("aria-label",t)}static initInstanceVariables(){this.adContainer=null,this.debug=!1,this.rmpVastInitialized=!1,this.useContentPlayerForAds=!1,this.contentPlayerCompleted=!1,this.currentContentSrc="",this.currentContentCurrentTime=-1,this.needsSeekAdjust=!1,this.seekAdjustAttached=!1,this.firstVastPlayerPlayRequest=!0,this.firstContentPlayerPlayRequest=!0,this.params={},this.events={},this.onFullscreenchange=a.nullFn,this.contentWrapper=null,this.contentPlayer=null,this.id=null,this.container=null,this.isInFullscreen=!1,this.adPod=!1,this.adPodLength=0,this.adSequence=0}static resetVariablesForNewLoadAds(){this.off("adstarted",this.attachViewableObserver),this.onLoadedmetadataPlay=a.nullFn,this.onPlaybackError=a.nullFn,this.onPause=a.nullFn,this.onPlay=a.nullFn,this.onPlaying=a.nullFn,this.onEnded=a.nullFn,this.onVolumeChange=a.nullFn,this.onTimeupdate=a.nullFn,this.onEventPingTracking=a.nullFn,this.onClickThrough=a.nullFn,this.onPlayingAppendIcons=a.nullFn,this.onDurationChange=a.nullFn,this.onTimeupdateCheckSkip=a.nullFn,this.onClickSkip=a.nullFn,this.onNonLinearLoadSuccess=a.nullFn,this.onNonLinearLoadError=a.nullFn,this.onNonLinearClickThrough=a.nullFn,this.onContextMenu=a.nullFn,this.adTagUrl="",this.vpaidSlot=null,this.trackingTags=[],this.vastErrorTags=[],this.adErrorTags=[],this.vastPlayerMuted=!1,this.vastPlayerDuration=-1,this.vastPlayerCurrentTime=-1,this.firstQuartileEventFired=!1,this.midpointEventFired=!1,this.thirdQuartileEventFired=!1,this.vastPlayerPaused=!1,this.vastErrorCode=-1,this.adErrorType="",this.vastErrorMessage="",this.adOnStage=!1,this.hlsJS=[],this.hlsJSIndex=0,this.readingHlsJS=!1,this.iconsData=[],this.clickUIOnMobile=null,this.customPlaybackCurrentTime=0,this.antiSeekLogicInterval=null,this.creativeLoadTimeoutCallback=null,this.ad={},this.creative={},this.attachViewableObserver=null,this.viewableObserver=null,this.viewablePreviousRatio=.5,this.regulationsInfo={},this.requireCategory=!1,this.progressEvents=[],this.skipButton=null,this.skipWaiting=null,this.skipMessage=null,this.skipIcon=null,this.skippableAdCanBeSkipped=!1,this.nonLinearContainer=null,this.nonLinearATag=null,this.nonLinearInnerElement=null,this.onClickCloseNonLinear=a.nullFn,this.nonLinearMinSuggestedDuration=0,this.validCompanionAds=[],this.companionAdsRequiredAttribute="",this.companionAdsList=[],this.isVPAID=!1,this.vpaidCreative=null,this.vpaidScript=null,this.vpaidIframe=null,this.vpaidLoadTimeout=null,this.initAdTimeout=null,this.startAdTimeout=null,this.vpaidAvailableInterval=null,this.adStoppedTimeout=null,this.adSkippedTimeout=null,this.adParametersData="",this.vpaidCurrentVolume=1,this.vpaidPaused=!1,this.vpaidCreativeUrl="",this.vpaidAdRemainingTimeInterval=null,this.vpaidRemainingTime=-1,this.vpaidVersion=-1,this.vpaid1AdDuration=-1,this.initialWidth=640,this.initialHeight=360,this.initialViewMode="normal",this.desiredBitrate=500,this.vpaidAdLoaded=!1,this.vpaidAdStarted=!1,this.vpaidCallbacks={}}static _onFullscreenchange(e){e&&e.type&&("fullscreenchange"===e.type?this.isInFullscreen?(this.isInFullscreen=!1,this.adOnStage&&this.creative.isLinear&&E.dispatch.call(this,["exitFullscreen","playerCollapse"])):(this.isInFullscreen=!0,this.adOnStage&&this.creative.isLinear&&E.dispatch.call(this,["fullscreen","playerExpand"])):"webkitbeginfullscreen"===e.type?(this.adOnStage&&this.creative.isLinear&&E.dispatch.call(this,["fullscreen","playerExpand"]),this.isInFullscreen=!0):"webkitendfullscreen"===e.type&&(this.adOnStage&&this.creative.isLinear&&E.dispatch.call(this,["exitFullscreen","playerCollapse"]),this.isInFullscreen=!1))}static handleFullscreen(){m.hasNativeFullscreenSupport&&(this.onFullscreenchange=u._onFullscreenchange.bind(this),m.isIos[0]?(this.contentPlayer.addEventListener("webkitbeginfullscreen",this.onFullscreenchange),this.contentPlayer.addEventListener("webkitendfullscreen",this.onFullscreenchange)):document.addEventListener("fullscreenchange",this.onFullscreenchange))}static _updateVastError(e){const t=li.filter(n=>n.code===e);t.length>0?(this.vastErrorCode=t[0].code,this.vastErrorMessage=t[0].description):(this.vastErrorCode=-1,this.vastErrorMessage="Error getting VAST error"),this.vastErrorCode>-1&&(ri.indexOf(this.vastErrorCode)>-1?this.adErrorType="adLoadError":oi.indexOf(this.vastErrorCode)>-1&&(this.adErrorType="adPlayError"))}static processVastErrors(e,t){t&&E.error.call(this,e),u._updateVastError.call(this,e),u.createApiEvent.call(this,"aderror"),L.resumeContent.call(this)}}let j=null;const di={data:{},length:0,getItem(i){return this.data[i]},setItem(i,e){this.data[i]=e,this.length=Object.keys(this.data).length},removeItem(i){delete this.data[i],this.length=Object.keys(this.data).length},clear(){this.data={},this.length=0}};class hi{constructor(){this.storage=this.initStorage()}initStorage(){if(j)return j;try{j=typeof window<"u"&&null!==window?window.localStorage||window.sessionStorage:null}catch{j=null}return j&&!this.isStorageDisabled(j)||(j=di,j.clear()),j}isStorageDisabled(e){const t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch{return!0}return e.removeItem(t),!1}getItem(e){return this.storage.getItem(e)}setItem(e,t){return this.storage.setItem(e,t)}removeItem(e){return this.storage.removeItem(e)}clear(){return this.storage.clear()}}function Ae(i={}){return{id:i.id||null,adId:i.adId||null,sequence:i.sequence||null,apiFramework:i.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}const ui=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function Se(i,e={},t={}){const n=[],s=we(i);!e.ERRORCODE||t.isCustomCode||/^[0-9]{3}$/.test(e.ERRORCODE)||(e.ERRORCODE=900),e.CACHEBUSTING=Ve(Math.round(1e8*Math.random()).toString()),e.TIMESTAMP=(new Date).toISOString(),e.RANDOM=e.random=e.CACHEBUSTING;for(const o in e)e[o]=xe(e[o]);for(const o in s){const r=s[o];"string"==typeof r&&n.push(Ie(r,e))}return n}function Ie(i,e){const t=(i=Re(i,e)).match(/[^[\]]+(?=])/g);if(!t)return i;let n=t.filter(s=>ui.indexOf(s)>-1);return 0===n.length?i:(n=n.reduce((s,o)=>(s[o]=-1,s),{}),Re(i,n))}function Re(i,e){let t=i;for(const n in e){const s=e[n];t=t.replace(new RegExp(`(?:\\[|%%)(${n})(?:\\]|%%)`,"g"),s)}return t}function we(i){return Array.isArray(i)?i.map(e=>e&&e.hasOwnProperty("url")?e.url:e):i}function Ne(i,e){for(let t=0;t<e.length;t++)if(Ue(e[t],i))return!0;return!1}function Ue(i,e){if(i&&e){const t=Object.getOwnPropertyNames(i),n=Object.getOwnPropertyNames(e);return t.length===n.length&&i.id===e.id&&i.url===e.url}return!1}function xe(i){return encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16)}`)}function Ve(i,e=8){const t=String(i);return t.length<e?De(0,e-t.length,!1).map(()=>"0").join("")+t:t}function De(i,e,t){const n=[],s=i<e,o=t?s?e+1:e-1:e;for(let r=i;s?r<o:r>o;s?r++:r--)n.push(r);return n}const X={track:function(i,e,t){Se(i,e,t).forEach(n=>{typeof window<"u"&&null!==window&&((new Image).src=n)})},resolveURLTemplates:Se,extractURLsFromTemplates:we,containsTemplateObject:Ne,isTemplateObjectEqual:Ue,encodeURIComponentRFC3986:xe,replaceUrlMacros:Ie,leftpad:Ve,range:De,isNumeric:function(i){return!isNaN(parseFloat(i))&&isFinite(i)},flatten:function i(e){return e.reduce((t,n)=>t.concat(Array.isArray(n)?i(n):n),[])},joinArrayOfUniqueTemplateObjs:function(i=[],e=[]){const t=Array.isArray(i)?i:[],n=Array.isArray(e)?e:[];return t.concat(n).reduce((s,o)=>(Ne(o,s)||s.push(o),s),[])}};function Oe(i){return-1!==["true","TRUE","True","1"].indexOf(i)}const c={childByName:function(i,e){const t=i.childNodes;for(const n in t){const s=t[n];if(s.nodeName===e)return s}},childrenByName:function(i,e){const t=[],n=i.childNodes;for(const s in n){const o=n[s];o.nodeName===e&&t.push(o)}return t},resolveVastAdTagURI:function(i,e){if(!e)return i;if(0===i.indexOf("//")){const{protocol:t}=location;return`${t}${i}`}return-1===i.indexOf("://")?`${e.slice(0,e.lastIndexOf("/"))}/${i}`:i},parseBoolean:Oe,parseNodeText:function(i){return i&&(i.textContent||i.text||"").trim()},copyNodeAttribute:function(i,e,t){const n=e.getAttribute(i);n&&t.setAttribute(i,n)},parseAttributes:function(i){const e=i.attributes,t={};for(let n=0;n<e.length;n++)t[e[n].nodeName]=e[n].nodeValue;return t},parseDuration:function(i){if(null==i)return-1;if(X.isNumeric(i))return parseInt(i);const e=i.split(":");if(3!==e.length)return-1;const t=e[2].split(".");let n=parseInt(t[0]);2===t.length&&(n+=parseFloat(`0.${t[1]}`));const s=parseInt(60*e[1]),o=parseInt(60*e[0]*60);return isNaN(o)||isNaN(s)||isNaN(n)||s>3600||n>60?-1:o+s+n},splitVAST:function(i){const e=[];let t=null;return i.forEach((n,s)=>{if(n.sequence&&(n.sequence=parseInt(n.sequence,10)),n.sequence>1){const o=i[s-1];if(o&&o.sequence===n.sequence-1)return void(t&&t.push(n));delete n.sequence}t=[n],e.push(t)}),e},assignAttributes:function(i,e){if(i)for(const t in i){const n=i[t];if(n.nodeName&&n.nodeValue&&e.hasOwnProperty(n.nodeName)){let s=n.nodeValue;"boolean"==typeof e[n.nodeName]&&(s=Oe(s)),e[n.nodeName]=s}}},mergeWrapperAdData:function(i,e){i.errorURLTemplates=e.errorURLTemplates.concat(i.errorURLTemplates),i.impressionURLTemplates=e.impressionURLTemplates.concat(i.impressionURLTemplates),i.extensions=e.extensions.concat(i.extensions),e.viewableImpression.length>0&&(i.viewableImpression=[...i.viewableImpression,...e.viewableImpression]),i.followAdditionalWrappers=e.followAdditionalWrappers,i.allowMultipleAds=e.allowMultipleAds,i.fallbackOnNoAd=e.fallbackOnNoAd;const t=(e.creatives||[]).filter(r=>r&&"companion"===r.type),n=t.reduce((r,l)=>((l.variations||[]).forEach(d=>{(d.companionClickTrackingURLTemplates||[]).forEach(h=>{X.containsTemplateObject(h,r)||r.push(h)})}),r),[]);i.creatives=t.concat(i.creatives);const s=e.videoClickTrackingURLTemplates&&e.videoClickTrackingURLTemplates.length,o=e.videoCustomClickURLTemplates&&e.videoCustomClickURLTemplates.length;1===i.creatives.length&&1===e.creatives.length&&(i.creatives[0].id=i.creatives[0].id||e.creatives[0].id),i.creatives.forEach(r=>{if(e.trackingEvents&&e.trackingEvents[r.type])for(const l in e.trackingEvents[r.type]){const d=e.trackingEvents[r.type][l];Array.isArray(r.trackingEvents[l])||(r.trackingEvents[l]=[]),r.trackingEvents[l]=r.trackingEvents[l].concat(d)}"linear"===r.type&&(s&&(r.videoClickTrackingURLTemplates=r.videoClickTrackingURLTemplates.concat(e.videoClickTrackingURLTemplates)),o&&(r.videoCustomClickURLTemplates=r.videoCustomClickURLTemplates.concat(e.videoCustomClickURLTemplates)),!e.videoClickThroughURLTemplate||null!=r.videoClickThroughURLTemplate||(r.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate)),"companion"===r.type&&n.length&&(r.variations||[]).forEach(l=>{l.companionClickTrackingURLTemplates=X.joinArrayOfUniqueTemplateObjs(l.companionClickTrackingURLTemplates,n)})}),e.adVerifications&&(i.adVerifications=i.adVerifications.concat(e.adVerifications)),e.blockedAdCategories&&(i.blockedAdCategories=i.blockedAdCategories.concat(e.blockedAdCategories))}};function pi(i,e){const t=function(n={}){const{id:s,adId:o,sequence:r,apiFramework:l}=Ae(n);return{id:s,adId:o,sequence:r,apiFramework:l,type:"companion",required:null,variations:[]}}(e);return t.required=i.getAttribute("required")||null,t.variations=c.childrenByName(i,"Companion").map(n=>{const s=function(l={}){return{id:l.id||null,adType:"companionAd",width:l.width||0,height:l.height||0,assetWidth:l.assetWidth||null,assetHeight:l.assetHeight||null,expandedWidth:l.expandedWidth||null,expandedHeight:l.expandedHeight||null,apiFramework:l.apiFramework||null,adSlotID:l.adSlotID||null,pxratio:l.pxratio||"1",renderingMode:l.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(c.parseAttributes(n));s.htmlResources=c.childrenByName(n,"HTMLResource").reduce((l,d)=>{const h=c.parseNodeText(d);return h?l.concat(h):l},[]),s.iframeResources=c.childrenByName(n,"IFrameResource").reduce((l,d)=>{const h=c.parseNodeText(d);return h?l.concat(h):l},[]),s.staticResources=c.childrenByName(n,"StaticResource").reduce((l,d)=>{const h=c.parseNodeText(d);return h?l.concat({url:h,creativeType:d.getAttribute("creativeType")||null}):l},[]),s.altText=c.parseNodeText(c.childByName(n,"AltText"))||null;const o=c.childByName(n,"TrackingEvents");o&&c.childrenByName(o,"Tracking").forEach(l=>{const d=l.getAttribute("event"),h=c.parseNodeText(l);d&&h&&(Array.isArray(s.trackingEvents[d])||(s.trackingEvents[d]=[]),s.trackingEvents[d].push(h))}),s.companionClickTrackingURLTemplates=c.childrenByName(n,"CompanionClickTracking").map(l=>({id:l.getAttribute("id")||null,url:c.parseNodeText(l)})),s.companionClickThroughURLTemplate=c.parseNodeText(c.childByName(n,"CompanionClickThrough"))||null;const r=c.childByName(n,"AdParameters");return r&&(s.adParameters=c.parseNodeText(r),s.xmlEncoded=r.getAttribute("xmlEncoded")||null),s}),t}function vi(i,e){let t;const n=function(d={}){const{id:h,adId:p,sequence:v,apiFramework:g}=Ae(d);return{id:h,adId:p,sequence:v,apiFramework:g,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(e);n.duration=c.parseDuration(c.parseNodeText(c.childByName(i,"Duration")));const s=i.getAttribute("skipoffset");if(null==s)n.skipDelay=null;else if("%"===s.charAt(s.length-1)&&-1!==n.duration){const d=parseInt(s,10);n.skipDelay=n.duration*(d/100)}else n.skipDelay=c.parseDuration(s);const o=c.childByName(i,"VideoClicks");if(o){const d=c.childByName(o,"ClickThrough");n.videoClickThroughURLTemplate=d?{id:d.getAttribute("id")||null,url:c.parseNodeText(d)}:null,c.childrenByName(o,"ClickTracking").forEach(h=>{n.videoClickTrackingURLTemplates.push({id:h.getAttribute("id")||null,url:c.parseNodeText(h)})}),c.childrenByName(o,"CustomClick").forEach(h=>{n.videoCustomClickURLTemplates.push({id:h.getAttribute("id")||null,url:c.parseNodeText(h)})})}const r=c.childByName(i,"AdParameters");r&&(n.adParameters=c.parseNodeText(r)),c.childrenByName(i,"TrackingEvents").forEach(d=>{c.childrenByName(d,"Tracking").forEach(h=>{let p=h.getAttribute("event");const v=c.parseNodeText(h);if(p&&v){if("progress"===p){if(t=h.getAttribute("offset"),!t)return;p="%"===t.charAt(t.length-1)?`progress-${t}`:`progress-${Math.round(c.parseDuration(t))}`}Array.isArray(n.trackingEvents[p])||(n.trackingEvents[p]=[]),n.trackingEvents[p].push(v)}})}),c.childrenByName(i,"MediaFiles").forEach(d=>{c.childrenByName(d,"MediaFile").forEach(y=>{n.mediaFiles.push(function(b){const I={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};I.id=b.getAttribute("id"),I.fileURL=c.parseNodeText(b),I.deliveryType=b.getAttribute("delivery"),I.codec=b.getAttribute("codec"),I.mimeType=b.getAttribute("type"),I.mediaType=b.getAttribute("mediaType")||"2D",I.apiFramework=b.getAttribute("apiFramework"),I.fileSize=parseInt(b.getAttribute("fileSize")||0),I.bitrate=parseInt(b.getAttribute("bitrate")||0),I.minBitrate=parseInt(b.getAttribute("minBitrate")||0),I.maxBitrate=parseInt(b.getAttribute("maxBitrate")||0),I.width=parseInt(b.getAttribute("width")||0),I.height=parseInt(b.getAttribute("height")||0);const _=b.getAttribute("scalable");_&&"string"==typeof _&&(I.scalable=c.parseBoolean(_));const q=b.getAttribute("maintainAspectRatio");return q&&"string"==typeof q&&(I.maintainAspectRatio=c.parseBoolean(q)),I}(y))});const h=c.childByName(d,"InteractiveCreativeFile");h&&(n.interactiveCreativeFile=function(y){const b=function(I={}){return{type:I.type||null,apiFramework:I.apiFramework||null,variableDuration:c.parseBoolean(I.variableDuration),fileURL:null}}(c.parseAttributes(y));return b.fileURL=c.parseNodeText(y),b}(h));const p=c.childByName(d,"ClosedCaptionFiles");p&&c.childrenByName(p,"ClosedCaptionFile").forEach(y=>{const b=function(I={}){return{type:I.type||null,language:I.language||null,fileURL:null}}(c.parseAttributes(y));b.fileURL=c.parseNodeText(y),n.closedCaptionFiles.push(b)});const v=c.childByName(d,"Mezzanine"),g=function(y,b){const I={};let _=!1;return["delivery","type","width","height"].forEach(q=>{y&&y.getAttribute(q)?I[q]=y.getAttribute(q):_=!0}),_?null:I}(v);if(g){const y={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};y.id=v.getAttribute("id"),y.fileURL=c.parseNodeText(v),y.delivery=g.delivery,y.codec=v.getAttribute("codec"),y.type=g.type,y.width=parseInt(g.width,10),y.height=parseInt(g.height,10),y.fileSize=parseInt(v.getAttribute("fileSize"),10),y.mediaType=v.getAttribute("mediaType")||"2D",n.mezzanine=y}});const l=c.childByName(i,"Icons");return l&&c.childrenByName(l,"Icon").forEach(d=>{n.icons.push(function(h){const p={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};var g;p.program=h.getAttribute("program"),p.height=parseInt(h.getAttribute("height")||0),p.width=parseInt(h.getAttribute("width")||0),p.xPosition=(g=h.getAttribute("xPosition"),-1!==["left","right"].indexOf(g)?g:parseInt(g||0)),p.yPosition=function(g){return-1!==["top","bottom"].indexOf(g)?g:parseInt(g||0)}(h.getAttribute("yPosition")),p.apiFramework=h.getAttribute("apiFramework"),p.pxratio=h.getAttribute("pxratio")||"1",p.offset=c.parseDuration(h.getAttribute("offset")),p.duration=c.parseDuration(h.getAttribute("duration")),c.childrenByName(h,"HTMLResource").forEach(g=>{p.type=g.getAttribute("creativeType")||"text/html",p.htmlResource=c.parseNodeText(g)}),c.childrenByName(h,"IFrameResource").forEach(g=>{p.type=g.getAttribute("creativeType")||0,p.iframeResource=c.parseNodeText(g)}),c.childrenByName(h,"StaticResource").forEach(g=>{p.type=g.getAttribute("creativeType")||0,p.staticResource=c.parseNodeText(g)});const v=c.childByName(h,"IconClicks");return v&&(p.iconClickThroughURLTemplate=c.parseNodeText(c.childByName(v,"IconClickThrough")),c.childrenByName(v,"IconClickTracking").forEach(g=>{p.iconClickTrackingURLTemplates.push({id:g.getAttribute("id")||null,url:c.parseNodeText(g)})})),p.iconViewTrackingURLTemplate=c.parseNodeText(c.childByName(h,"IconViewTracking")),p}(d))}),n}function mi(i,e){const t=function(n={}){const{id:s,adId:o,sequence:r,apiFramework:l}=Ae(n);return{id:s,adId:o,sequence:r,apiFramework:l,type:"nonlinear",variations:[],trackingEvents:{}}}(e);return c.childrenByName(i,"TrackingEvents").forEach(n=>{let s,o;c.childrenByName(n,"Tracking").forEach(r=>{s=r.getAttribute("event"),o=c.parseNodeText(r),s&&o&&(Array.isArray(t.trackingEvents[s])||(t.trackingEvents[s]=[]),t.trackingEvents[s].push(o))})}),c.childrenByName(i,"NonLinear").forEach(n=>{const s={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};s.id=n.getAttribute("id")||null,s.width=n.getAttribute("width"),s.height=n.getAttribute("height"),s.expandedWidth=n.getAttribute("expandedWidth"),s.expandedHeight=n.getAttribute("expandedHeight"),s.scalable=c.parseBoolean(n.getAttribute("scalable")),s.maintainAspectRatio=c.parseBoolean(n.getAttribute("maintainAspectRatio")),s.minSuggestedDuration=c.parseDuration(n.getAttribute("minSuggestedDuration")),s.apiFramework=n.getAttribute("apiFramework"),c.childrenByName(n,"HTMLResource").forEach(r=>{s.type=r.getAttribute("creativeType")||"text/html",s.htmlResource=c.parseNodeText(r)}),c.childrenByName(n,"IFrameResource").forEach(r=>{s.type=r.getAttribute("creativeType")||0,s.iframeResource=c.parseNodeText(r)}),c.childrenByName(n,"StaticResource").forEach(r=>{s.type=r.getAttribute("creativeType")||0,s.staticResource=c.parseNodeText(r)});const o=c.childByName(n,"AdParameters");o&&(s.adParameters=c.parseNodeText(o)),s.nonlinearClickThroughURLTemplate=c.parseNodeText(c.childByName(n,"NonLinearClickThrough")),c.childrenByName(n,"NonLinearClickTracking").forEach(r=>{s.nonlinearClickTrackingURLTemplates.push({id:r.getAttribute("id")||null,url:c.parseNodeText(r)})}),t.variations.push(s)}),t}function Me(i){const e=[];return i.forEach(t=>{const n=Fe(t);n&&e.push(n)}),e}function Fe(i){if("#comment"===i.nodeName)return null;const e={name:null,value:null,attributes:{},children:[]},t=i.attributes,n=i.childNodes;if(e.name=i.nodeName,i.attributes)for(const o in t)if(t.hasOwnProperty(o)){const r=t[o];r.nodeName&&r.nodeValue&&(e.attributes[r.nodeName]=r.nodeValue)}for(const o in n)if(n.hasOwnProperty(o)){const r=Fe(n[o]);r&&e.children.push(r)}if(0===e.children.length||1===e.children.length&&["#cdata-section","#text"].indexOf(e.children[0].name)>=0){const o=c.parseNodeText(i);""!==o&&(e.value=o),e.children=[]}return null===(s=e).value&&0===Object.keys(s.attributes).length&&0===s.children.length?null:e;var s}function gi(i){const e=[];return i.forEach(t=>{const n={id:t.getAttribute("id")||null,adId:Ai(t),sequence:t.getAttribute("sequence")||null,apiFramework:t.getAttribute("apiFramework")||null},s=[];let o;c.childrenByName(t,"UniversalAdId").forEach(l=>{const d={idRegistry:l.getAttribute("idRegistry")||"unknown",value:c.parseNodeText(l)};s.push(d)});const r=c.childByName(t,"CreativeExtensions");r&&(o=Me(c.childrenByName(r,"CreativeExtension")));for(const l in t.childNodes){const d=t.childNodes[l];let h;switch(d.nodeName){case"Linear":h=vi(d,n);break;case"NonLinearAds":h=mi(d,n);break;case"CompanionAds":h=pi(d,n)}h&&(s&&(h.universalAdIds=s),o&&(h.creativeExtensions=o),e.push(h))}}),e}function Ai(i){return i.getAttribute("AdID")||i.getAttribute("adID")||i.getAttribute("adId")||null}const le={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function Be(i,e){if(!le[i.nodeName]||!le[i.nodeName].attributes)return;const t=le[i.nodeName].attributes.filter(n=>!i.getAttribute(n));t.length>0&&ie({name:i.nodeName,parentName:i.parentNode.nodeName,attributes:t},e)}function We(i,e,t){const n=le[i.nodeName];if(n&&(t||"Wrapper"===i.nodeName)){if(n.subElements){const o=n.subElements.filter(r=>!c.childByName(i,r));o.length>0&&ie({name:i.nodeName,parentName:i.parentNode.nodeName,subElements:o},e)}!t||!n.oneOfinLineResources||n.oneOfinLineResources.some(o=>c.childByName(i,o))||ie({name:i.nodeName,parentName:i.parentNode.nodeName,oneOfResources:n.oneOfinLineResources},e)}}function qe(i){return i.children&&0!==i.children.length}function ie({name:i,parentName:e,attributes:t,subElements:n,oneOfResources:s},o){let r=`Element '${i}'`;r+=t?` missing required attribute(s) '${t.join(", ")}' `:n?` missing required sub element(s) '${n.join(", ")}' `:s?` must provide one of the following '${s.join(", ")}' `:" is empty",o("VAST-warning",{message:r,parentElement:e,specVersion:4.1})}const fi={verifyRequiredValues:function i(e,t,n){if(e&&e.nodeName)if("InLine"===e.nodeName&&(n=!0),Be(e,t),qe(e)){We(e,t,n);for(let s=0;s<e.children.length;s++)i(e.children[s],t,n)}else 0===c.parseNodeText(e).length&&ie({name:e.nodeName,parentName:e.parentNode.nodeName},t)},hasSubElements:qe,emitMissingValueWarning:ie,verifyRequiredAttributes:Be,verifyRequiredSubElements:We};function yi(i,e,{allowMultipleAds:t,followAdditionalWrappers:n}={}){const s=i.childNodes;for(const o in s){const r=s[o];if(-1!==["Wrapper","InLine"].indexOf(r.nodeName)&&("Wrapper"!==r.nodeName||!1!==n)){if(c.copyNodeAttribute("id",i,r),c.copyNodeAttribute("sequence",i,r),c.copyNodeAttribute("adType",i,r),"Wrapper"===r.nodeName)return{ad:Ci(r,e),type:"WRAPPER"};if("InLine"===r.nodeName)return{ad:Ti(r,e,{allowMultipleAds:t}),type:"INLINE"}}}}function Ti(i,e,{allowMultipleAds:t}={}){return!1===t&&i.getAttribute("sequence")?null:He(i,e)}function He(i,e){let t=[];e&&fi.verifyRequiredValues(i,e);const n=i.childNodes,s=function(o={}){return{id:o.id||null,sequence:o.sequence||null,adType:o.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(c.parseAttributes(i));for(const o in n){const r=n[o];switch(r.nodeName){case"Error":s.errorURLTemplates.push(c.parseNodeText(r));break;case"Impression":s.impressionURLTemplates.push({id:r.getAttribute("id")||null,url:c.parseNodeText(r)});break;case"Creatives":s.creatives=gi(c.childrenByName(r,"Creative"));break;case"Extensions":{const l=c.childrenByName(r,"Extension");s.extensions=Me(l),s.adVerifications.length||(t=Ei(l));break}case"AdVerifications":s.adVerifications=je(c.childrenByName(r,"Verification"));break;case"AdSystem":s.system={value:c.parseNodeText(r),version:r.getAttribute("version")||null};break;case"AdTitle":s.title=c.parseNodeText(r);break;case"AdServingId":s.adServingId=c.parseNodeText(r);break;case"Category":s.categories.push({authority:r.getAttribute("authority")||null,value:c.parseNodeText(r)});break;case"Expires":s.expires=parseInt(c.parseNodeText(r),10);break;case"ViewableImpression":s.viewableImpression.push(bi(r));break;case"Description":s.description=c.parseNodeText(r);break;case"Advertiser":s.advertiser={id:r.getAttribute("id")||null,value:c.parseNodeText(r)};break;case"Pricing":s.pricing={value:c.parseNodeText(r),model:r.getAttribute("model")||null,currency:r.getAttribute("currency")||null};break;case"Survey":s.survey=c.parseNodeText(r);break;case"BlockedAdCategories":s.blockedAdCategories.push({authority:r.getAttribute("authority")||null,value:c.parseNodeText(r)})}}return t.length&&(s.adVerifications=s.adVerifications.concat(t)),s}function Ci(i,e){const t=He(i,e),n=i.getAttribute("followAdditionalWrappers"),s=i.getAttribute("allowMultipleAds"),o=i.getAttribute("fallbackOnNoAd");t.followAdditionalWrappers=!n||c.parseBoolean(n),t.allowMultipleAds=!!s&&c.parseBoolean(s),t.fallbackOnNoAd=o?c.parseBoolean(o):null;let r=c.childByName(i,"VASTAdTagURI");if(r?t.nextWrapperURL=c.parseNodeText(r):(r=c.childByName(i,"VASTAdTagURL"),r&&(t.nextWrapperURL=c.parseNodeText(c.childByName(r,"URL")))),t.creatives.forEach(l=>{if(-1!==["linear","nonlinear"].indexOf(l.type)){if(l.trackingEvents){t.trackingEvents||(t.trackingEvents={}),t.trackingEvents[l.type]||(t.trackingEvents[l.type]={});for(const d in l.trackingEvents){const h=l.trackingEvents[d];Array.isArray(t.trackingEvents[l.type][d])||(t.trackingEvents[l.type][d]=[]),h.forEach(p=>{t.trackingEvents[l.type][d].push(p)})}}l.videoClickTrackingURLTemplates&&(Array.isArray(t.videoClickTrackingURLTemplates)||(t.videoClickTrackingURLTemplates=[]),l.videoClickTrackingURLTemplates.forEach(d=>{t.videoClickTrackingURLTemplates.push(d)})),l.videoClickThroughURLTemplate&&(t.videoClickThroughURLTemplate=l.videoClickThroughURLTemplate),l.videoCustomClickURLTemplates&&(Array.isArray(t.videoCustomClickURLTemplates)||(t.videoCustomClickURLTemplates=[]),l.videoCustomClickURLTemplates.forEach(d=>{t.videoCustomClickURLTemplates.push(d)}))}}),t.nextWrapperURL)return t}function je(i){const e=[];return i.forEach(t=>{const n={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},s=t.childNodes;c.assignAttributes(t.attributes,n);for(const r in s){const l=s[r];switch(l.nodeName){case"JavaScriptResource":case"ExecutableResource":n.resource=c.parseNodeText(l),c.assignAttributes(l.attributes,n);break;case"VerificationParameters":n.parameters=c.parseNodeText(l)}}const o=c.childByName(t,"TrackingEvents");o&&c.childrenByName(o,"Tracking").forEach(r=>{const l=r.getAttribute("event"),d=c.parseNodeText(r);l&&d&&(Array.isArray(n.trackingEvents[l])||(n.trackingEvents[l]=[]),n.trackingEvents[l].push(d))}),e.push(n)}),e}function Ei(i){let e=null,t=[];return i.some(n=>e=c.childByName(n,"AdVerifications")),e&&(t=je(c.childrenByName(e,"Verification"))),t}function bi(i){const e={};e.id=i.getAttribute("id")||null;const t=i.childNodes;for(const n in t){const s=t[n],o=s.nodeName,r=c.parseNodeText(s);if(("Viewable"===o||"NotViewable"===o||"ViewUndetermined"===o)&&r){const l=o.toLowerCase();Array.isArray(e[l])||(e[l]=[]),e[l].push(r)}}return e}class ki{constructor(){this._handlers=[]}on(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type "+typeof t);if(!e)throw new TypeError("The event argument must be of type String. Received type "+typeof e);return this._handlers.push({event:e,handler:t}),this}once(e,t){return this.on(e,function(n,s,o){const r={fired:!1,wrapFn:void 0};function l(...d){r.fired||(n.off(s,r.wrapFn),r.fired=!0,o.bind(n)(...d))}return r.wrapFn=l,l}(this,e,t))}off(e,t){return this._handlers=this._handlers.filter(n=>n.event!==e||n.handler!==t),this}emit(e,...t){let n=!1;return this._handlers.forEach(s=>{"*"===s.event&&(n=!0,s.handler(e,...t)),s.event===e&&(n=!0,s.handler(...t))}),n}removeAllListeners(e){return e?(this._handlers=this._handlers.filter(t=>t.event!==e),this):(this._handlers=[],this)}listenerCount(e){return this._handlers.filter(t=>t.event===e).length}listeners(e){return this._handlers.reduce((t,n)=>(n.event===e&&t.push(n.handler),t),[])}eventNames(){return this._handlers.map(e=>e.event)}}function Je(){try{const i=new window.XMLHttpRequest;return"withCredentials"in i?i:null}catch{return null}}function ce(i,e,t){const n=t?408:i.status;e(new Error(t?`XHRURLHandler: Request timed out after ${i.timeout} ms (${n})`:`XHRURLHandler: ${i.statusText} (${n})`),null,{statusCode:n})}const Li={get:function(i,e,t){return t||("function"==typeof e&&(t=e),e={}),typeof window>"u"||null===window?function(i,e,t){t(new Error("Please bundle the library for node to use the node urlHandler"))}(0,0,t):Je()?function(i,e,t){if("https:"===window.location.protocol&&0===i.indexOf("http://"))return t(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{const n=Je();n.open("GET",i),n.timeout=e.timeout||12e4,n.withCredentials=e.withCredentials||!1,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.onload=()=>{return o=t,void(200===(s=n).status?o(null,s.responseXML,{byteLength:s.response.length,statusCode:s.status}):ce(s,o,!1));var s,o},n.onerror=()=>ce(n,t,!1),n.onabort=()=>ce(n,t,!1),n.ontimeout=()=>ce(n,t,!0),n.send()}catch{t(new Error("XHRURLHandler: Unexpected error"))}}(i,e,t):t(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}};let ze=0,fe=0;const Ye=(i,e)=>{!i||!e||i<=0||e<=0||(fe=(fe*ze+8*i/e)/++ze)},Si={ERRORCODE:900,extensions:[]};class Ke extends ki{constructor(){super(),this.remainingAds=[],this.parentURLs=[],this.errorURLTemplates=[],this.rootErrorURLTemplates=[],this.maxWrapperDepth=null,this.URLTemplateFilters=[],this.fetchingOptions={},this.parsingOptions={}}addURLTemplateFilter(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}removeURLTemplateFilter(){this.URLTemplateFilters.pop()}countURLTemplateFilters(){return this.URLTemplateFilters.length}clearURLTemplateFilters(){this.URLTemplateFilters=[]}trackVastError(e,t,...n){this.emit("VAST-error",Object.assign({},Si,t,...n)),X.track(e,t)}getErrorURLTemplates(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}getEstimatedBitrate(){return fe}fetchVAST(e,t=0,n=null,s=null){return new Promise((o,r)=>{this.URLTemplateFilters.forEach(d=>{e=d(e)});const l=Date.now();this.emit("VAST-resolving",{url:e,previousUrl:n,wrapperDepth:t,maxWrapperDepth:this.maxWrapperDepth,timeout:this.fetchingOptions.timeout,wrapperAd:s}),this.urlHandler.get(e,this.fetchingOptions,(d,h,p={})=>{const v=Math.round(Date.now()-l),g=Object.assign({url:e,previousUrl:n,wrapperDepth:t,error:d,duration:v},p);this.emit("VAST-resolved",g),Ye(p.byteLength,v),d?r(d):o(h)})})}initParsingStatus(e={}){this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||12e4,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||Li,this.vastVersion=null,Ye(e.byteLength,e.requestDuration)}getRemainingAds(e){if(0===this.remainingAds.length)return Promise.reject(new Error("No more ads are available for the given VAST"));const t=e?X.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(t,{wrapperDepth:0,url:this.rootURL}).then(n=>this.buildVASTResponse(n))}getAndParseVAST(e,t={}){return this.initParsingStatus(t),this.URLTemplateFilters.forEach(n=>{e=n(e)}),this.rootURL=e,this.fetchVAST(e).then(n=>(t.previousUrl=e,t.isRootVAST=!0,t.url=e,this.parse(n,t).then(s=>this.buildVASTResponse(s))))}parseVAST(e,t={}){return this.initParsingStatus(t),t.isRootVAST=!0,this.parse(e,t).then(n=>this.buildVASTResponse(n))}buildVASTResponse(e){const t=function({ads:n,errorURLTemplates:s,version:o}){return{ads:n||[],errorURLTemplates:s||[],version:o||null}}({ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion});return this.completeWrapperResolving(t),t}parseVastXml(e,{isRootVAST:t=!1,url:n=null,wrapperDepth:s=0,allowMultipleAds:o,followAdditionalWrappers:r}){if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:n,wrapperDepth:s}),new Error("Invalid VAST XMLDocument");const l=[],d=e.documentElement.childNodes,h=e.documentElement.getAttribute("version");t&&h&&(this.vastVersion=h);for(const p in d){const v=d[p];if("Error"===v.nodeName){const g=c.parseNodeText(v);t?this.rootErrorURLTemplates.push(g):this.errorURLTemplates.push(g)}else if("Ad"===v.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)o=!0;else if(!1===o&&l.length>1)break;const g=yi(v,this.emit.bind(this),{allowMultipleAds:o,followAdditionalWrappers:r});g.ad?(l.push(g.ad),this.emit("VAST-ad-parsed",{type:g.type,url:n,wrapperDepth:s,adIndex:l.length-1,vastVersion:h})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return l}parse(e,{url:t=null,resolveAll:n=!0,wrapperSequence:s=null,previousUrl:o=null,wrapperDepth:r=0,isRootVAST:l=!1,followAdditionalWrappers:d,allowMultipleAds:h}={}){let p=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&l&&(h=!0);try{p=this.parseVastXml(e,{isRootVAST:l,url:t,wrapperDepth:r,allowMultipleAds:h,followAdditionalWrappers:d})}catch(v){return Promise.reject(v)}return 1===p.length&&null!=s&&(p[0].sequence=s),!1===n&&(this.remainingAds=c.splitVAST(p),p=this.remainingAds.shift()),this.resolveAds(p,{wrapperDepth:r,previousUrl:o,url:t})}resolveAds(e=[],{wrapperDepth:t,previousUrl:n,url:s}){const o=[];return n=s,e.forEach(r=>{const l=this.resolveWrappers(r,t,n);o.push(l)}),Promise.all(o).then(r=>{const l=X.flatten(r);if(!l&&this.remainingAds.length>0){const d=this.remainingAds.shift();return this.resolveAds(d,{wrapperDepth:t,previousUrl:n,url:s})}return l})}resolveWrappers(e,t,n){return new Promise(s=>{if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,s(e);if(t>=this.maxWrapperDepth)return e.errorCode=302,delete e.nextWrapperURL,s(e);e.nextWrapperURL=c.resolveVastAdTagURI(e.nextWrapperURL,n),this.URLTemplateFilters.forEach(l=>{e.nextWrapperURL=l(e.nextWrapperURL)});const o=this.parsingOptions.allowMultipleAds??e.allowMultipleAds,r=e.sequence;this.fetchVAST(e.nextWrapperURL,t,n,e).then(l=>this.parse(l,{url:e.nextWrapperURL,previousUrl:n,wrapperSequence:r,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:o}).then(d=>{if(delete e.nextWrapperURL,0===d.length)return e.creatives=[],s(e);d.forEach(h=>{h&&c.mergeWrapperAdData(h,e)}),s(d)})).catch(l=>{e.errorCode=301,e.errorMessage=l.message,s(e)})})}completeWrapperResolving(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(let t=e.ads.length-1;t>=0;t--){const n=e.ads[t];(n.errorCode||0===n.creatives.length)&&(this.trackVastError(n.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:n.errorCode||303},{ERRORMESSAGE:n.errorMessage||""},{extensions:n.extensions},{system:n.system}),e.ads.splice(t,1))}}}class Ii{constructor(e,t,n){this.cappingFreeLunch=e||0,this.cappingMinimumTimeInterval=t||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new Ke,this.storage=n||new hi,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}getParser(){return this.vastParser}get lastSuccessfulAd(){return this.storage.getItem("vast-client-last-successful-ad")}set lastSuccessfulAd(e){this.storage.setItem("vast-client-last-successful-ad",e)}get totalCalls(){return this.storage.getItem("vast-client-total-calls")}set totalCalls(e){this.storage.setItem("vast-client-total-calls",e)}get totalCallsTimeout(){return this.storage.getItem("vast-client-total-calls-timeout")}set totalCallsTimeout(e){this.storage.setItem("vast-client-total-calls-timeout",e)}hasRemainingAds(){return this.vastParser.remainingAds.length>0}getNextAds(e){return this.vastParser.getRemainingAds(e)}get(e,t={}){const n=Date.now();return(t=Object.assign({},this.defaultOptions,t)).hasOwnProperty("resolveAll")||(t.resolveAll=!1),this.totalCallsTimeout<n?(this.totalCalls=1,this.totalCallsTimeout=n+36e5):this.totalCalls++,new Promise((s,o)=>{if(this.cappingFreeLunch>=this.totalCalls)return o(new Error(`VAST call canceled \u2013 FreeLunch capping not reached yet ${this.totalCalls}/${this.cappingFreeLunch}`));const r=n-this.lastSuccessfulAd;if(r<0)this.lastSuccessfulAd=0;else if(r<this.cappingMinimumTimeInterval)return o(new Error(`VAST call canceled \u2013 (${this.cappingMinimumTimeInterval})ms minimum interval reached`));this.vastParser.getAndParseVAST(e,t).then(l=>s(l)).catch(l=>o(l))})}}var Ri=R(379),wi=R.n(Ri),Ni=R(795),Ui=R.n(Ni),xi=R(569),Vi=R.n(xi),Di=R(565),Oi=R.n(Di),Mi=R(216),Fi=R.n(Mi),Bi=R(589),Wi=R.n(Bi),de=R(83),Q={};Q.styleTagTransform=Wi(),Q.setAttributes=Oi(),Q.insert=Vi().bind(null,"head"),Q.domAPI=Ui(),Q.insertStyleElement=Fi(),wi()(de.Z,Q);class qi{constructor(e){u.initInstanceVariables.call(this),this.contentWrapper=e.contentWrapper,this.contentPlayer=e.contentPlayer,null!==this.contentWrapper&&null!==this.contentPlayer?(u.resetVariablesForNewLoadAds.call(this),u.handleFullscreen.call(this),u.filterParams.call(this,e),this.params.forceUseContentPlayerForAds&&(this.useContentPlayerForAds=!0)):console.error("Invalid DOM layout - exit")}dispatch(e,t){const n=this.events[e];if(n){const s={type:e};t&&(s.data=t),n.fire(s)}}_on(e,t){let n=this.events[e];n||(n=new class{constructor(i){this.eventName=i,this.callbacks=[]}registerCallback(i){this.callbacks.push(i)}unregisterCallback(i){const e=this.callbacks.indexOf(i);e>-1&&this.callbacks.splice(e,1)}fire(i){this.callbacks.slice(0).forEach(e=>{e(i)})}}(e),this.events[e]=n),n.registerCallback(t)}on(e,t){"string"!=typeof e||""===e||"function"!=typeof t||e.split(" ").forEach(n=>{this._on(n,t)})}_one(e,t){const n=function(s){this.off(e,n),t(s)}.bind(this);this.on(e,n)}one(e,t){"string"!=typeof e||""===e||"function"!=typeof t||e.split(" ").forEach(n=>{this._one(n,t)})}_off(e,t){const n=this.events[e];n&&n.callbacks.indexOf(t)>-1&&(n.unregisterCallback(t),0===n.callbacks.length&&delete this.events[e])}off(e,t){"string"!=typeof e||""===e||"function"!=typeof t||e.split(" ").forEach(n=>{this._off(n,t)})}getEnvironment(){return m}_addTrackingEvents(e){Object.keys(e).forEach(t=>{e[t].forEach(n=>{this.trackingTags.push({event:t,url:n})})})}_parseCompanion(e){this.validCompanionAds=[],this.companionAdsRequiredAttribute="",e.required&&(this.companionAdsRequiredAttribute=e.required);const t=e.variations;if(t.length>0)for(let n=0;n<t.length;n++){const s=t[n],o={width:s.width,height:s.height},r=s.staticResources.find(h=>{if(h.url)return!0}),l=s.iframeResources.find(h=>{if(h)return!0}),d=s.htmlResources.find(h=>{if(h)return!0});r&&r.url&&(o.imageUrl=r.url),l&&l.length>0&&(o.iframeUrl=l),d&&d.length>0&&(o.htmlContent=d),void 0===r&&void 0===l&&void 0===d||(s.companionClickThroughURLTemplate&&(o.companionClickThroughUrl=s.companionClickThroughURLTemplate),s.companionClickTrackingURLTemplates.length>0&&(o.companionClickTrackingUrls=s.companionClickTrackingURLTemplates),s.altText&&(o.altText=s.altText),s.adSlotID&&(o.adSlotID=s.adSlotID),o.trackingEventsUrls=[],s.trackingEvents&&s.trackingEvents.creativeView&&s.trackingEvents.creativeView.forEach(h=>{o.trackingEventsUrls.push(h)}),this.validCompanionAds.push(o))}}_handleIntersect(e){e.forEach(t=>{t.intersectionRatio>this.viewablePreviousRatio&&(this.viewableObserver.unobserve(this.contentWrapper),u.createApiEvent.call(this,"adviewable"),E.dispatch.call(this,"viewable")),this.viewablePreviousRatio=t.intersectionRatio})}_attachViewableObserver(){if(this.off("adstarted",this.attachViewableObserver),void 0!==window.IntersectionObserver){const e={root:null,rootMargin:"0px",threshold:[.5]};this.viewableObserver=new IntersectionObserver(this._handleIntersect.bind(this),e),this.viewableObserver.observe(this.contentWrapper)}else u.createApiEvent.call(this,"adviewundetermined"),E.dispatch.call(this,"viewundetermined")}_initViewableImpression(){this.viewableObserver&&this.viewableObserver.unobserve(this.contentWrapper),this.ad.viewableImpression.forEach(e=>{e.viewable.length>0&&e.viewable.forEach(t=>{this.trackingTags.push({event:"viewable",url:t})}),e.notviewable.length>0&&e.notviewable.forEach(t=>{this.trackingTags.push({event:"notviewable",url:t})}),e.viewundetermined.length>0&&e.viewundetermined.forEach(t=>{this.trackingTags.push({event:"viewundetermined",url:t})})}),this.attachViewableObserver=this._attachViewableObserver.bind(this),this.on("adstarted",this.attachViewableObserver)}_loopAds(e){var t=this;return ee(function*(){for(let n=0;n<e.length;n++)yield new Promise(s=>{const o=e[n];if(!o)return;if(t.ad.id=o.id,t.ad.adServingId=o.adServingId,t.ad.categories=o.categories,t.requireCategory&&(0!==t.ad.categories.length&&t.ad.categories[0].authority||(u.processVastErrors.call(t,204,!0),s())),t.ad.blockedAdCategories=o.blockedAdCategories,t.requireCategory){let l=!1;t.ad.blockedAdCategories.forEach(d=>{const h=d.authority,p=d.value;t.ad.categories.forEach(v=>{h===v.authority&&p===v.value&&(u.processVastErrors.call(t,205,!0),l=!0)})}),l&&s()}if(t.ad.adType=o.adType,t.ad.title=o.title,t.ad.description=o.description,t.ad.system=o.system,t.ad.advertiser=o.advertiser,t.ad.pricing=o.pricing,t.ad.survey=o.survey,t.ad.sequence=o.sequence,e.find(l=>{if(t.adPod=!1,l.sequence&&l.sequence>1)return t.adPod=!0,!0}),t.adPod){let l=e.reduce(function(d,h){return d.sequence>h.sequence?d:h}).sequence;e.forEach(d=>{null===d.sequence&&(d.sequence=l+1,l++)})}if(t.adPod&&(t.adSequence++,0===t.adPodLength)){let l=0;e.forEach(d=>{d.sequence&&l++}),t.adPodLength=l}t.ad.viewableImpression=o.viewableImpression,t.ad.viewableImpression.length>0&&t._initViewableImpression(),o.errorURLTemplates.forEach(l=>{t.adErrorTags.push({event:"error",url:l})}),o.impressionURLTemplates.forEach(l=>{l.url&&t.trackingTags.push({event:"impression",url:l.url})}),t.one("stopadloop",()=>{n=e.length}),t.one("addestroyed",()=>{t.adPod&&t.adSequence===t.adPodLength&&(t.adPodLength=0,t.adSequence=0,t.adPod=!1,u.createApiEvent.call(t,"adpodcompleted")),s()});const r=o.creatives;r.find(l=>{if("companion"===l.type)return t._parseCompanion(l),!0});for(let l=0;l<r.length;l++){const d=r[l];if("companion"!==d.type)switch(t.creative.id=d.id,t.creative.universalAdIds=d.universalAdIds,t.creative.adId=d.adId,t.creative.trackingEvents=d.trackingEvents,d.type){case"linear":t.creative.duration=d.duration,t.creative.skipDelay=d.skipDelay,t.creative.skipDelay&&(t.creative.skipoffset=d.skipDelay,t.creative.isSkippableAd=!0),d.videoClickThroughURLTemplate&&d.videoClickThroughURLTemplate.url&&(t.creative.clickThroughUrl=d.videoClickThroughURLTemplate.url),d.videoClickTrackingURLTemplates.length>0&&d.videoClickTrackingURLTemplates.forEach(h=>{h.url&&t.trackingTags.push({event:"clickthrough",url:h.url})}),t.creative.isLinear=!0,t._addTrackingEvents(d.trackingEvents),Le.parse.call(t,d.icons,d.adParameters,d.mediaFiles);break;case"nonlinear":t.creative.isLinear=!1,t._addTrackingEvents(d.trackingEvents),ve.parse.call(t,d.variations)}}})})()}_handleParsedVast(e){e.errorURLTemplates.length>0&&e.errorURLTemplates.forEach(t=>{this.vastErrorTags.push({event:"error",url:t})}),0!==e.ads.length?this._loopAds(e.ads):u.processVastErrors.call(this,303,!0)}_getVastTag(e){if("string"==typeof e&&""!==e)if(typeof DOMParser<"u")if(u.createApiEvent.call(this,"adtagstartloading"),this.params.vastXmlInput){let t;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch{return void u.processVastErrors.call(this,900,!0)}(new Ke).parseVAST(t).then(n=>{u.createApiEvent.call(this,"adtagloaded"),this._handleParsedVast(n)}).catch(n=>{u.processVastErrors.call(this,900,!0)})}else{const t=new Ii,n={timeout:this.params.ajaxTimeout,withCredentials:this.params.ajaxWithCredentials,wrapperLimit:this.params.maxNumRedirects,resolveAll:!1,allowMultipleAds:!0};this.adTagUrl=e,t.get(this.adTagUrl,n).then(s=>{u.createApiEvent.call(this,"adtagloaded"),this.response=s,this._handleParsedVast(s)}).catch(s=>{u.processVastErrors.call(this,900,!0)})}else u.processVastErrors.call(this,1002,!1);else u.processVastErrors.call(this,1001,!1)}loadAds(e,t,n){this.rmpVastInitialized||this.initialize(),"object"==typeof t&&(t.regulations&&/coppa|gdpr/gi.test(t.regulations)&&(this.regulationsInfo.regulations=t.regulations),t.limitAdTracking&&/0|1/gi.test(t.limitAdTracking)&&(this.regulationsInfo.limitAdTracking=t.limitAdTracking),t.gdprConsent&&(this.regulationsInfo.gdprConsent=t.gdprConsent)),n&&(this.requireCategory=!0);let s=e;if(this.params.vastXmlInput||(s=E.replaceMacros.call(this,e,!1)),this.getAdOnStage())return this.one("addestroyed",function(l){this.loadAds(l)}.bind(this,s)),void this.stopAds();const o=D.getCurrentTime.call(this);this.useContentPlayerForAds&&(this.currentContentSrc=this.contentPlayer.src,this.currentContentCurrentTime=o,D.preventSeekingForCustomPlayback.call(this)),this._getVastTag(s)}play(){return this.adOnStage&&this.creative?this.creative.isLinear?this.isVPAID?w.resumeAd.call(this):L.play.call(this):ve.play.call(this):D.play.call(this)}pause(){this.adOnStage&&this.creative&&this.creative.isLinear?this.isVPAID?w.pauseAd.call(this):L.pause.call(this):D.pause.call(this)}getAdPaused(){return!!(this.adOnStage&&this.creative&&this.creative.isLinear)&&(this.isVPAID?w.getAdPaused.call(this):this.vastPlayerPaused)}setVolume(e){if(!a.isNumber(e))return;let t=0;t=e<0?0:e>1?1:e,this.adOnStage&&this.creative&&this.creative.isLinear&&(this.isVPAID&&w.setAdVolume.call(this,t),L.setVolume.call(this,t)),D.setVolume.call(this,t)}getVolume(){return this.adOnStage&&this.creative&&this.creative.isLinear?this.isVPAID?w.getAdVolume.call(this):L.getVolume.call(this):D.getVolume.call(this)}setMute(e){"boolean"==typeof e&&(this.adOnStage&&this.creative&&this.creative.isLinear&&(this.isVPAID?w.setAdVolume.call(this,e?0:1):L.setMute.call(this,e)),D.setMute.call(this,e))}getMute(){return this.adOnStage&&this.creative&&this.creative.isLinear?this.isVPAID?0===w.getAdVolume.call(this):L.getMute.call(this):D.getMute.call(this)}getFullscreen(){return this.isInFullscreen}stopAds(){this.adOnStage&&(this.isVPAID&&(w.stopAd.call(this),w.destroy.call(this)),L.resumeContent.call(this))}stopAdsLoop(){u.createApiEvent.call(this,"stopadloop"),this.adPodLength=0,this.adSequence=0,this.adPod=!1,this.stopAds()}destroy(){this.contentPlayer?(this.contentPlayer.removeEventListener("webkitbeginfullscreen",this.onFullscreenchange),this.contentPlayer.removeEventListener("webkitendfullscreen",this.onFullscreenchange)):document.removeEventListener("fullscreenchange",this.onFullscreenchange),this.adContainer&&this.adContainer.remove(),L.destroy.call(this),u.initInstanceVariables.call(this)}skipAd(){this.adOnStage&&this.getAdSkippableState()&&(this.isVPAID?w.skipAd.call(this):(u.createApiEvent.call(this,"adskipped"),E.dispatch.call(this,"skip")),L.resumeContent.call(this))}getAdTagUrl(){return this.adTagUrl}getAdMediaUrl(){if(this.adOnStage){if(this.isVPAID)return w.getCreativeUrl.call(this);if(this.creative&&this.creative.mediaUrl)return this.creative.mediaUrl}return""}getAdLinear(){return!(!this.creative||!this.creative.isLinear)}getAdSystem(){return this.ad&&this.ad.system?{value:this.ad.system.value||"",version:this.ad.system.version||""}:{value:"",version:""}}getAdUniversalAdIds(){return this.creative&&this.creative.universalAdIds?this.creative.universalAdIds:[]}getAdContentType(){return this.creative&&this.creative.type?this.creative.type:""}getAdTitle(){return this.ad&&this.ad.title?this.ad.title:""}getAdDescription(){return this.ad&&this.ad.description?this.ad.description:""}getAdAdvertiser(){return this.ad&&this.ad.advertiser&&null!==this.ad.advertiser?this.ad.advertiser:{id:"",value:""}}getAdPricing(){return this.ad&&this.ad.pricing&&null!==this.ad.pricing?this.ad.pricing:{value:"",model:"",currency:""}}getAdSurvey(){return this.ad&&this.ad.survey?this.ad.survey:""}getAdAdServingId(){return this.ad&&this.ad.adServingId?this.ad.adServingId:""}getAdCategories(){return this.ad&&this.ad.categories&&this.ad.categories.length>0?this.ad.categories:[]}getAdBlockedAdCategories(){return this.ad&&this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length>0?this.ad.blockedAdCategories:[]}getAdDuration(){if(this.adOnStage&&this.creative&&this.creative.isLinear){if(this.isVPAID){let e=w.getAdDuration.call(this);return e>0&&(e*=1e3),Math.round(e)}return L.getDuration.call(this)}return-1}getAdCurrentTime(){if(this.adOnStage&&this.creative&&this.creative.isLinear){if(this.isVPAID){const e=w.getAdRemainingTime.call(this),t=w.getAdDuration.call(this);return-1===e||-1===t||e>t?-1:1e3*Math.round(t-e)}return L.getCurrentTime.call(this)}return-1}getAdRemainingTime(){if(this.adOnStage&&this.creative&&this.creative.isLinear){if(this.isVPAID){let e=w.getAdRemainingTime.call(this);return e>0&&(e*=1e3),Math.round(e)}{const e=L.getCurrentTime.call(this),t=L.getDuration.call(this);return-1===e||-1===t||e>t?-1:t-e}}return-1}getAdOnStage(){return this.adOnStage}getAdMediaWidth(){if(this.adOnStage){if(this.isVPAID)return w.getAdWidth.call(this);if(this.creative&&this.creative.width)return this.creative.width}return-1}getAdMediaHeight(){if(this.adOnStage){if(this.isVPAID)return w.getAdHeight.call(this);if(this.creative&&this.creative.height)return this.creative.height}return-1}getClickThroughUrl(){return this.creative&&this.creative.clickThroughUrl?this.creative.clickThroughUrl:""}getSkipTimeOffset(){return this.creative&&this.creative.skipoffset?this.creative.skipoffset:-1}getIsSkippableAd(){return!(!this.creative||!this.creative.isSkippableAd)}getContentPlayerCompleted(){return this.contentPlayerCompleted}setContentPlayerCompleted(e){"boolean"==typeof e&&(this.contentPlayerCompleted=e)}getAdErrorMessage(){return this.vastErrorMessage}getAdVastErrorCode(){return this.vastErrorCode}getAdErrorType(){return this.adErrorType}getIsUsingContentPlayerForAds(){return this.useContentPlayerForAds}getAdSkippableState(){if(this.adOnStage){if(this.isVPAID)return w.getAdSkippableState.call(this);if(this.getIsSkippableAd())return this.skippableAdCanBeSkipped}return!1}getVastPlayer(){return this.vastPlayer}getContentPlayer(){return this.contentPlayer}getCompanionAdsList(e,t){if(this.validCompanionAds.length>0){let n;if(n="number"==typeof e&&e>0&&"number"==typeof t&&t>0?this.validCompanionAds.filter(s=>e>=s.width&&t>=s.height):this.validCompanionAds,n.length>0)return this.companionAdsList=n,this.companionAdsList}return[]}getCompanionAd(e){if(void 0===this.companionAdsList[e])return null;const t=this.companionAdsList[e];let n;if(t.imageUrl||t.iframeUrl?(t.imageUrl?n=document.createElement("img"):(n=document.createElement("iframe"),n.sandbox="allow-scripts allow-same-origin"),t.altText&&(n.alt=t.altText),n.width=t.width,n.height=t.height,n.style.cursor="pointer"):t.htmlContent&&(n=t.htmlContent),t.imageUrl||t.iframeUrl){const s=t.trackingEventsUrls;s.length>0&&(n.onload=()=>{s.forEach(l=>{E.pingURI.call(this,l)})},n.onerror=()=>{E.error.call(this,603)});let o=null;t.companionClickTrackingUrls&&(o=t.companionClickTrackingUrls);const r=function(l,d,h){h&&(h.stopPropagation(),"touchend"===h.type&&h.preventDefault()),d&&d.forEach(p=>{p.url&&E.pingURI.call(this,p.url)}),a.openWindow(l)};t.companionClickThroughUrl&&(n.addEventListener("touchend",r.bind(this,t.companionClickThroughUrl,o)),n.addEventListener("click",r.bind(this,t.companionClickThroughUrl,o)))}if(t.imageUrl)n.src=t.imageUrl;else if(t.iframeUrl)n.src=t.iframeUrl;else if(t.htmlContent)try{n=(new DOMParser).parseFromString(t.htmlContent,"text/html"),n=n.documentElement}catch{return null}return n}getCompanionAdsRequiredAttribute(){return this.adOnStage?this.companionAdsRequiredAttribute:""}initialize(){this.rmpVastInitialized||L.init.call(this)}getInitialized(){return this.rmpVastInitialized}getAdPodInfo(){if(this.adPod&&this.adPodLength){const e={};return e.adPodCurrentIndex=this.adSequence,e.adPodLength=this.adPodLength,e}return{adPodCurrentIndex:-1,adPodLength:0}}isFirstAd(){const{adPodCurrentIndex:e,adPodLength:t}=this.getAdPodInfo();return 0===t||1===e}isLastAd(){const{adPodCurrentIndex:e,adPodLength:t}=this.getAdPodInfo();return 0===t||t===e}resizeAd(e,t,n){this.adOnStage&&this.isVPAID&&w.resizeAd.call(this,e,t,n)}expandAd(){this.adOnStage&&this.isVPAID&&w.expandAd.call(this)}collapseAd(){this.adOnStage&&this.isVPAID&&w.collapseAd.call(this)}getAdExpanded(){return this.adOnStage&&this.isVPAID&&w.getAdExpanded.call(this),!1}getVPAIDCompanionAds(){return this.adOnStage&&this.isVPAID&&w.getAdCompanions.call(this),""}}})(),se.RmpVast=Y.RmpVast}()},9293:Z=>{function se(ee,te,K,R,Y,a,A){try{var f=ee[a](A),T=f.value}catch(S){return void K(S)}f.done?te(T):Promise.resolve(T).then(R,Y)}Z.exports=function he(ee){return function(){var te=this,K=arguments;return new Promise(function(R,Y){var a=ee.apply(te,K);function A(T){se(a,R,Y,A,f,"next",T)}function f(T){se(a,R,Y,A,f,"throw",T)}A(void 0)})}},Z.exports.__esModule=!0,Z.exports.default=Z.exports}}]);